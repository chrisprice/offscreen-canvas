(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array"),require("d3-scale"),require("d3-time"),require("d3-random"),require("d3-fetch"),require("d3-path"),require("d3-selection"),require("d3-shape"),require("d3-dispatch"),require("d3-brush")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-scale","d3-time","d3-random","d3-fetch","d3-path","d3-selection","d3-shape","d3-dispatch","d3-brush"],t):(e=e||self,t(e.fc={},e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3))})(this,function(e,t,a,n,i,r,l,o,s,c,u){'use strict';var O=Math.round,G=Math.floor,U=Math.min,F=Math.ceil,M=Math.exp,Y=Math.max,W=Math.abs;function h(e){return e}function g(){}function f(e){return"function"==typeof e?e:()=>e}function p(e){return"number"==typeof e&&isNaN(e)?void 0:e}function m(){let e=()=>10,t=g,a=h,n=e=>null!=e;var i=function(i){const r=e.apply(this,arguments),l=i.slice(0,r).map(a);return i.map((e,d)=>(d>=r&&(l.shift(),l.push(a(e,d))),d<r-1||l.some(e=>!n(e))?t(void 0,d):t(l,d)))};return i.period=(...t)=>t.length?(e=f(t[0]),i):e,i.accumulator=(...e)=>e.length?(t=e[0],i):t,i.defined=(...e)=>e.length?(n=e[0],i):n,i.value=(...e)=>e.length?(a=e[0],i):a,i}function b(){let e=2;const a=m().accumulator(a=>{const n=a&&t.deviation(a),i=a&&t.mean(a);return{average:i,upper:p(i+e*n),lower:p(i-e*n)}}),n=e=>a(e);return n.multiplier=(...t)=>t.length?(e=t[0],n):e,q(n,a,"period","value"),n}function y(){let e=h,a=()=>9;const n=e=>{let a=[];return n=>{let i;return a.length<e&&(null==n?a=[]:a.push(n)),a.length>=e&&(i=t.mean(a)),i}},i=function(t){const i=a.apply(this,arguments),r=2/(i+1),l=n(i);let o;return t.map((t,a)=>{const n=e(t,a);return o=void 0===o?l(n):n*r+(1-r)*o,p(o)})};return i.period=(...e)=>e.length?(a=f(e[0]),i):a,i.value=(...t)=>t.length?(e=t[0],i):e,i}function x(){let e=h;const a=y().period(12),n=y().period(26),i=y().period(9),r=r=>{a.value(e),n.value(e);const l=t.zip(a(r),n(r)).map(e=>void 0!==e[0]&&void 0!==e[1]?e[0]-e[1]:void 0),d=i(l);return t.zip(l,d).map(e=>({macd:e[0],signal:e[1],divergence:void 0!==e[0]&&void 0!==e[1]?e[0]-e[1]:void 0}))};return r.value=(...t)=>t.length?(e=t[0],r):e,X(r,a,$({period:"fastPeriod"})),X(r,n,$({period:"slowPeriod"})),X(r,i,$({period:"signalPeriod"})),r}function v(){const e=m().accumulator(e=>e&&t.mean(e)),a=t=>e(t);return q(a,e,"period","value"),a}function S(){let e=.1,t=h;const a=a=>a.map(a=>{const n=p(t(a)*(1-e)),i=p(t(a)*(1+e));return{lower:n,upper:i}});return a.factor=(...t)=>t.length?(e=t[0],a):e,a.value=(...e)=>e.length?(t=e[0],a):t,a}function w(){let e=e=>e.close,a=e=>e.high,n=e=>e.low;const i=y().period(13),r=r=>(i.value(e),t.zip(r,i(r)).map(e=>{const t=p(a(e[0])-e[1]),i=p(n(e[0])-e[1]);return{bullPower:t,bearPower:i}}));return r.closeValue=(...t)=>t.length?(e=t[0],r):e,r.highValue=(...e)=>e.length?(a=e[0],r):a,r.lowValue=(...e)=>e.length?(n=e[0],r):n,q(r,i,"period"),r}function A(){var e={};return e.distance=function(e,t){return t-e},e.offset=function(e,t){return e instanceof Date?new Date(e.getTime()+t):e+t},e.clampUp=e=>e,e.clampDown=e=>e,e.copy=()=>e,e}function V(e,t){const a=[];for(const n of e){const e=t.clampUp(n),i=t.clampDown(n);e===i&&a.push(e)}return a}function k(e){arguments.length||(e=a.scaleIdentity());var t=A();const n=a=>{var n=e.domain(),i=e.range(),r=t.distance(n[0],n[1]),l=t.distance(n[0],a),d=l/r*(i[1]-i[0])+i[0];return d};return n.invert=a=>{var n=e.domain(),i=e.range(),r=(a-i[0])/(i[1]-i[0]),l=t.distance(n[0],n[1]);return t.offset(n[0],r*l)},n.domain=(...a)=>{if(!a.length)return e.domain();const i=a[0];var r=t.clampUp(i[0]),l=t.clampDown(i[1]);return e.domain([r,l]),n},n.nice=()=>{e.nice();var a=e.domain(),i=t.clampUp(a[0]),r=t.clampDown(a[1]);return e.domain([i,r]),n},n.ticks=(...a)=>{var n=e.ticks.apply(this,a);return V(n,t)},n.copy=()=>k(e.copy()).discontinuityProvider(t.copy()),n.discontinuityProvider=(...e)=>e.length?(t=e[0],n):t,X(n,e,J("range","rangeRound","interpolate","clamp","tickFormat")),n}function E(){let e=[e=>e],a=[0,0],n="percent",i=null,r=[];const l=l=>{const d=Array(l.length);for(const t of e)for(let e=0;e<l.length;e++){const a=t(l[e],e);Array.isArray(a)?d.push(...a):d.push(a)}const o=[t.min(d),t.max(d)];if(o[0]=null==o[0]?t.min(r):t.min([o[0],...r]),o[1]=null==o[1]?t.max(r):t.max([o[1],...r]),null!=i){const e=Y(W(o[1]-i),W(o[0]-i));o[0]=i-e,o[1]=i+e}switch(n){case"domain":{o[0]-=a[0],o[1]+=a[1];break}case"percent":{const e=o[1]-o[0];o[0]-=a[0]*e,o[1]+=a[1]*e;break}default:throw new Error(`Unknown padUnit: ${n}`);}return o};return l.accessors=(...t)=>t.length?(e=t[0],l):e,l.pad=(...e)=>e.length?(a=e[0],l):a,l.padUnit=(...e)=>e.length?(n=e[0],l):n,l.include=(...e)=>e.length?(r=e[0],l):r,l.symmetricalAbout=(...e)=>e.length?(i=e[0],l):i,l}function I(){let e=[],t=[0,0],a="percent",n=null,i=[];const r=E(),l=e=>null==e?null:e.valueOf(),d=d=>{const o=e.map(e=>(...t)=>{const a=e(...t);return Array.isArray(a)?a.map(l):l(a)});return r.accessors(o).pad(t).padUnit(a).symmetricalAbout(null==n?null:n.valueOf()).include(i.map(e=>e.valueOf())),r(d).map(e=>new Date(e))};return d.accessors=(...t)=>t.length?(e=t[0],d):e,d.pad=(...e)=>e.length?(t=e[0],d):t,d.padUnit=(...e)=>e.length?(a=e[0],d):a,d.include=(...e)=>e.length?(i=e[0],d):i,d.symmetricalAbout=(...e)=>e.length?(n=e[0],d):n,d}function _(){let e=1,t=20,a=.1,n=.1,r=i.randomNormal();var l=(i=0)=>{var l=Math.sqrt;const d=e/t,o=[];for(let e=0;e<t+1;e++){o.push(i);const e=r()*l(d)*n+(a-n*n/2)*d;i*=M(e)}return o};return l.period=(...t)=>t.length?(e=t[0],l):e,l.steps=(...e)=>e.length?(t=e[0],l):t,l.mu=(...e)=>e.length?(a=e[0],l):a,l.sigma=(...e)=>e.length?(n=e[0],l):n,l.random=(...e)=>e.length?(r=e[0],l):r,l}function T(e){return"function"==typeof e?e:()=>e}function N(){let e=new Date,t=100,a=n.timeDay,r=1,l=n.timeYear,d=1,o=null,s=()=>{const e=i.randomNormal(1,.1);return F(1e3*e())};const c=_(),u=e=>{const t=l.offset(e,d)-e;return(a.offset(e,r)-e)/t},h=(e,t)=>{const a=u(e),n=c.period(a)(t),i={date:e,open:n[0],high:Y.apply(Math,n),low:U.apply(Math,n),close:n[c.steps()]};return i.volume=s(i),i},g=n=>{let i,l,d;do i=n?a.offset(n.date,r):new Date(e.getTime()),l=n?n.close:t,n=h(i,l),d=o&&!o(n);while(d);return n},f=()=>{let e;const t={};return t.next=()=>{const t=g(e);return e=t,t},t.take=e=>t.until((t,a)=>!e||0>e||a===e),t.until=t=>{const a=[];let n=0,i=g(e),r=t&&!t(i,n);for(;r;)a.push(i),e=i,i=g(e),n+=1,r=t&&!t(i,n);return a},t},p=e=>f().take(e);if(p.stream=f,"function"!=typeof Symbol||"symbol"!=typeof Symbol.iterator)throw new Error("d3fc-random-data depends on Symbol. Make sure that you load a polyfill in older browsers. See README.");return p[Symbol.iterator]=()=>{const e=f();return{next:()=>({value:e.next(),done:!1})}},p.startDate=(...t)=>t.length?(e=t[0],p):e,p.startPrice=(...e)=>e.length?(t=e[0],p):t,p.interval=(...e)=>e.length?(a=e[0],p):a,p.intervalStep=(...e)=>e.length?(r=e[0],p):r,p.unitInterval=(...e)=>e.length?(l=e[0],p):l,p.unitIntervalStep=(...e)=>e.length?(d=e[0],p):d,p.filter=(...e)=>e.length?(o=e[0],p):o,p.volume=(...e)=>e.length?(s=T(e[0]),p):s,X(p,c),p}function B(){var e="BTC-USD",t=null,a=null,n=null,i=function(){var i=[];null!=t&&i.push("start="+t.toISOString()),null!=a&&i.push("end="+a.toISOString()),null!=n&&i.push("granularity="+n);var l="https://api.gdax.com/products/"+e+"/candles?"+i.join("&");return r.json(l).then(function(e){return e.map(function(e){return{date:new Date(1e3*e[0]),open:e[3],high:e[2],low:e[1],close:e[4],volume:e[5]}})})};return i.product=function(t){return arguments.length?(e=t,i):e},i.start=function(e){return arguments.length?(t=e,i):t},i.end=function(e){return arguments.length?(a=e,i):a},i.granularity=function(e){return arguments.length?(n=e,i):n},i}function R(){var e=10,a=a=>1>=e?a.map(e=>[e]):t.range(0,F(a.length/e)).map(t=>a.slice(t*e,(t+1)*e));return a.bucketSize=function(t){return arguments.length?(e=t,a):e},a}function z(){function e(e){var a=e.map(e=>[n(e),i(e)]),r=t.range(1,a.length-1).map(e=>{var t=a[e-1],n=a[e],i=a[e+1];return .5*W((t[0]-i[0])*(n[1]-t[1])-(t[0]-n[0])*(i[1]-t[1]))});return r}var a=R(),n=e=>e,i=e=>e;const r=n=>{if(a.bucketSize()>=n.length)return n;var i=e(n),r=a(i),l=a(n.slice(1,n.length-1)),d=l.map((e,a)=>{var n=r[a],i=t.max(n),l=n.indexOf(i);return e[l]});return[].concat([n[0]],d,[n[n.length-1]])};return q(r,a,"bucketSize"),r.x=function(e){return arguments.length?(n=e,r):n},r.y=function(e){return arguments.length?(i=e,r):i},r}function P(){var e=e=>e,a=e=>e,n=R();const i=i=>{if(n.bucketSize()>=i.length)return i;var r=n(i.slice(1,i.length-1)),l=i[0],d=i[i.length-1],o=[].concat([l],r,[d]),s=e(l),c=a(l),u=r.map((n,r)=>{var i=t.mean(o[r+1],e),l=t.mean(o[r+1],a),d=n.map(t=>[e(t),a(t)]),u=d.map(e=>.5*W((s-i)*(e[1]-c)-(s-e[0])*(l-c))),h=u.indexOf(t.max(u)),g=d[h];return s=g[0],c=g[1],n[h]});return[].concat([i[0]],u,[i[i.length-1]])};return q(i,n,"bucketSize"),i.x=function(t){return arguments.length?(e=t,i):e},i.y=function(e){return arguments.length?(a=e,i):a},i}function D(){var e=R(),a=e=>e;const n=n=>{if(e.bucketSize()>n.length)return n;var i=t.extent(n,a),r=e(n.slice(1,n.length-1)),l=r.map(e=>{var t,n,r={},l=!0,d=e.map(a),o=d.filter(e=>e===i[0]||e===i[1]).map(e=>d.indexOf(e))[0];return void 0===o?(d.forEach((e,a)=>{void 0===r[e]&&(r[e]=0),r[e]++,r[e]>r[t]||void 0===t?(t=e,n=a,l=!0):r[e]===r[t]&&(l=!1)}),l?e[n]:e[G(e.length/2)]):e[o]});return[].concat([n[0]],l,[n[n.length-1]])};return q(n,e,"bucketSize"),n.value=function(e){return arguments.length?(a=e,n):a},n}function L(){const e=arguments;return function(t,a){for(let n=0,i=e.length;n<i;n++)if(null==e[n](t,a))return!1;return!0}}function C(e){switch(e){case ft.BYTE:case ft.UNSIGNED_BYTE:return 1;case ft.SHORT:case ft.UNSIGNED_SHORT:return 2;case ft.FLOAT:return 4;default:throw new Error(`Unknown type ${e}`);}}function H(e){switch(e){case ft.BYTE:return Int8Array;case ft.UNSIGNED_BYTE:return Uint8Array;case ft.SHORT:return Int16Array;case ft.UNSIGNED_SHORT:return Uint16Array;case ft.FLOAT:return Float32Array;default:throw new Error(`Unknown type ${e}`);}}var Q=(e,t,a)=>{const n=t[a];if("function"!=typeof n)throw new Error(`Attempt to rebind ${a} which isn't a function on the source object`);return(...a)=>{var i=n.apply(t,a);return i===t?e:i}},q=(e,t,...a)=>{for(const n of a)e[n]=Q(e,t,n);return e};const j=e=>t=>e.reduce((e,t)=>e&&t(e),t);var X=(e,t,...a)=>{const n=j(a);for(const i of Object.keys(t)){const a=n(i);a&&(e[a]=Q(e,t,i))}return e},K=e=>e.map(e=>"string"==typeof e?new RegExp(`^${e}$`):e),Z=(...e)=>(e=K(e),t=>e.every(e=>!e.test(t))&&t),J=(...e)=>(e=K(e),t=>e.some(e=>e.test(t))&&t),$=e=>t=>e[t];const ee=e=>e[0].toUpperCase()+e.slice(1);var te=e=>t=>e+ee(t);const ae=(e,t,a,n)=>{const i={sunday:0,monday:1,saturday:6},r=86400000,l=5*r,d={},o=t=>0===e(t)||6===e(t);return d.clampDown=a=>{if(a&&o(a)){const n=t.ceil(a);return e(n)===i.sunday?t.offset(n,-1):e(n)===i.monday?t.offset(n,-2):n}return a},d.clampUp=a=>{if(a&&o(a)){const n=t.floor(a);return e(n)===i.saturday?t.offset(n,2):e(n)===i.sunday?t.offset(n,1):n}return a},d.distance=function(e,t){e=d.clampUp(e),t=d.clampDown(t);const n=a.ceil(e);if(t<n)return t.getTime()-e.getTime();const i=n.getTime()-e.getTime(),o=a.ceil(t),s=o.getTime()-t.getTime(),c=O((o.getTime()-n.getTime())/(7*r));return c*l+i-s},d.offset=function(e,i){let r=o(e)?d.clampUp(e):e;if(0===i)return r;const s=0>i;let c=i;const u=s?n.floor(r):a.ceil(r);if(c-=u.getTime()-r.getTime(),s&&0<c||0<i&&0>c)return new Date(r.getTime()+i);r=s?u:t.offset(u,2);const h=G(c/l);return r=t.offset(r,7*h),c-=h*l,r=new Date(r.getTime()+c),r},d.copy=function(){return d},d};var ne=e=>"function"==typeof e?e:()=>e,ie=()=>{let e=null,t=e=>e.date,a=e=>e.open,n=e=>e.high,r=e=>e.low,o=e=>e.close,s="vertical",c=ne(3);const u=function(i){const u=e||l.path();return i.forEach(function(e,l){const i=t(e,l),d=a(e,l),h=n(e,l),g=r(e,l),f=o(e,l),p=c(e,l)/2;"vertical"===s?(u.moveTo(i,g),u.lineTo(i,h),u.moveTo(i,d),u.lineTo(i-p,d),u.moveTo(i,f),u.lineTo(i+p,f)):(u.moveTo(g,i),u.lineTo(h,i),u.moveTo(d,i),u.lineTo(d,i+p),u.moveTo(f,i),u.lineTo(f,i-p))}),e?null:u.toString()};return u.context=(...t)=>t.length?(e=t[0],u):e,u.x=(...e)=>e.length?(t=ne(e[0]),u):t,u.open=(...e)=>e.length?(a=ne(e[0]),u):a,u.high=(...e)=>e.length?(n=ne(e[0]),u):n,u.low=(...e)=>e.length?(r=ne(e[0]),u):r,u.close=(...e)=>e.length?(o=ne(e[0]),u):o,u.width=(...e)=>e.length?(c=ne(e[0]),u):c,u.orient=(...e)=>e.length?(s=e[0],u):s,u},re=()=>{let e=null,t=e=>e.x,a=e=>e.y,n="center",i="center",r=e=>e.height,o=ne(3);const s=function(d,s){const c=e||l.path();return d.forEach(function(e,l){const d=t.call(this,e,s||l),u=a.call(this,e,s||l),h=r.call(this,e,s||l),g=o.call(this,e,s||l);let f;switch(n){case"left":f=g;break;case"right":f=0;break;case"center":f=g/2;break;default:throw new Error("Invalid horizontal alignment "+n);}let p;switch(i){case"bottom":p=-h;break;case"top":p=0;break;case"center":p=h/2;break;default:throw new Error("Invalid vertical alignment "+i);}c.rect(d-f,u-p,g,h)},this),e?null:c.toString()};return s.context=(...t)=>t.length?(e=t[0],s):e,s.x=(...e)=>e.length?(t=ne(e[0]),s):t,s.y=(...e)=>e.length?(a=ne(e[0]),s):a,s.width=(...e)=>e.length?(o=ne(e[0]),s):o,s.horizontalAlign=(...e)=>e.length?(n=e[0],s):n,s.height=(...e)=>e.length?(r=ne(e[0]),s):r,s.verticalAlign=(...e)=>e.length?(i=e[0],s):i,s},le=()=>{let e=null,t=e=>e.date,a=e=>e.open,n=e=>e.high,r=e=>e.low,o=e=>e.close,s=ne(3);const c=function(i){const c=e||l.path();return i.forEach(function(e,l){const i=t(e,l),d=a(e,l),u=n(e,l),h=r(e,l),g=o(e,l),f=s(e,l);c.rect(i-f/2,d,f,g-d),c.moveTo(i,U(g,d)),c.lineTo(i,u),c.moveTo(i,Y(g,d)),c.lineTo(i,h)}),e?null:c.toString()};return c.context=(...t)=>t.length?(e=t[0],c):e,c.x=(...e)=>e.length?(t=ne(e[0]),c):t,c.open=(...e)=>e.length?(a=ne(e[0]),c):a,c.high=(...e)=>e.length?(n=ne(e[0]),c):n,c.low=(...e)=>e.length?(r=ne(e[0]),c):r,c.close=(...e)=>e.length?(o=ne(e[0]),c):o,c.width=(...e)=>e.length?(s=ne(e[0]),c):s,c},de=()=>{let e=null,t=e=>e.value,a=e=>e.median,n=e=>e.upperQuartile,r=e=>e.lowerQuartile,o=e=>e.high,s=e=>e.low,c="vertical",u=ne(5),h=ne(.5);const g=function(i){const g=e||l.path();return i.forEach(function(e,l){const i=t(e,l),d=u(e,l),f=d/2,p=d*h(e,l),m=p/2,b=o(e,l),y=n(e,l),x=a(e,l),v=r(e,l),S=s(e,l),w=v-y;"vertical"===c?(g.moveTo(i-m,b),g.lineTo(i+m,b),g.moveTo(i,b),g.lineTo(i,y),g.rect(i-f,y,d,w),g.moveTo(i-f,x),g.lineTo(i+f,x),g.moveTo(i,v),g.lineTo(i,S),g.moveTo(i-m,S),g.lineTo(i+m,S)):(g.moveTo(S,i-m),g.lineTo(S,i+m),g.moveTo(S,i),g.lineTo(v,i),g.rect(v,i-f,-w,d),g.moveTo(x,i-f),g.lineTo(x,i+f),g.moveTo(y,i),g.lineTo(b,i),g.moveTo(b,i-m),g.lineTo(b,i+m))}),e?null:g.toString()};return g.context=(...t)=>t.length?(e=t[0],g):e,g.value=(...e)=>e.length?(t=ne(e[0]),g):t,g.median=(...e)=>e.length?(a=ne(e[0]),g):a,g.upperQuartile=(...e)=>e.length?(n=ne(e[0]),g):n,g.lowerQuartile=(...e)=>e.length?(r=ne(e[0]),g):r,g.high=(...e)=>e.length?(o=ne(e[0]),g):o,g.low=(...e)=>e.length?(s=ne(e[0]),g):s,g.width=(...e)=>e.length?(u=ne(e[0]),g):u,g.orient=(...e)=>e.length?(c=e[0],g):c,g.cap=(...e)=>e.length?(h=ne(e[0]),g):h,g},oe=()=>{let e=null,t=e=>e.x,a=e=>e.high,n=e=>e.low,r="vertical",o=ne(5);const s=function(i){const s=e||l.path();return i.forEach(function(e,l){const i=t(e,l),d=o(e,l),c=d/2,u=a(e,l),h=n(e,l);"vertical"===r?(s.moveTo(i-c,u),s.lineTo(i+c,u),s.moveTo(i,u),s.lineTo(i,h),s.moveTo(i-c,h),s.lineTo(i+c,h)):(s.moveTo(h,i-c),s.lineTo(h,i+c),s.moveTo(h,i),s.lineTo(u,i),s.moveTo(u,i-c),s.lineTo(u,i+c))}),e?null:s.toString()};return s.context=(...t)=>t.length?(e=t[0],s):e,s.value=(...e)=>e.length?(t=ne(e[0]),s):t,s.high=(...e)=>e.length?(a=ne(e[0]),s):a,s.low=(...e)=>e.length?(n=ne(e[0]),s):n,s.width=(...e)=>e.length?(o=ne(e[0]),s):o,s.orient=(...e)=>e.length?(r=e[0],s):r,s},se=e=>"function"==typeof e?e:()=>e;const ce=1e-6;var ue=(e,t)=>{e=e||"g";let a=(e,t)=>t,n=null;const i=function(i,r){r=r||(e=>e);const l=i.selection?i:null;l&&(i=i.selection());const d=i.selectAll((e,t,a)=>Array.from(a[t].childNodes).filter(e=>1===e.nodeType)).filter(null==t?e:`${e}.${t}`);let o=d.data(r,a);const s=o.enter().append(e).attr("class",t);let c=o.exit();o=o.merge(s);const u=l||n;return u&&(o=o.transition(u).style("opacity",1),s.style("opacity",ce),c=c.transition(u).style("opacity",ce)),c.remove(),o.enter=()=>s,o.exit=()=>c,o};return i.element=(...t)=>t.length?(e=t[0],i):e,i.className=(...e)=>e.length?(t=e[0],i):t,i.key=(...e)=>e.length?(a=e[0],i):a,i.transition=(...e)=>e.length?(n=e[0],i):n,i};const he=(e,t)=>!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y);var ge=(e,t)=>{if(he(e,t)){const a=Y(e.x,t.x),n=U(e.x+e.width,t.x+t.width),i=Y(e.y,t.y),r=U(e.y+e.height,t.y+t.height);return(n-a)*(r-i)}return 0};const fe=(e,a)=>t.sum(e.map((t,n)=>a===n?0:ge(e[a],t))),pe=(e,t,a,n,i)=>({x:e,y:t,width:a,height:n,location:i});var me=e=>{const t=e.x,a=e.y,n=e.width,i=e.height;return[pe(t,a,n,i,"bottom-right"),pe(t-n,a,n,i,"bottom-left"),pe(t-n,a-i,n,i,"top-left"),pe(t,a-i,n,i,"top-right"),pe(t,a-i/2,n,i,"middle-right"),pe(t-n/2,a,n,i,"bottom-center"),pe(t-n,a-i/2,n,i,"middle-left"),pe(t-n/2,a-i,n,i,"top-center")]};const be=(e,t,a)=>[...e.slice(0,t),a,...e.slice(t+1)],ye=(e,t)=>e<t,xe=()=>{let e,a=null,n=ye,l=()=>0;const d=(t,n)=>a-l(e[n],n,e)+l(t,n,be(e,n,t)),o=(i,r)=>{a||(a=t.sum(e.map((t,a)=>l(t,a,e))));const s=d(i,r);return n(s,a)?xe().locationScore(l).winningScore(n).score(s).rectangles(be(e,r,i)):o};return o.rectangles=(...t)=>t.length?(e=t[0],o):e,o.score=(...e)=>e.length?(a=e[0],o):a,o.winningScore=(...e)=>e.length?(n=e[0],o):n,o.locationScore=(...e)=>e.length?(l=e[0],o):l,o};const ve=e=>e[Se(e)],Se=e=>G(Math.random()*e.length);const we=(e,a)=>e[t.scan(e,a)];var Ae=e=>"function"==typeof e?e:()=>e,Ve=(e,t)=>"left"===e?t/2:"right"===e?-t/2:0,ke=e=>{const t=Object.assign({},e),a=()=>{};return Object.keys(t).forEach(e=>{a[e]=(...n)=>n.length?(t[e]=n[0],a):t[e]}),a},Ee=()=>{let e=()=>0,t=e=>e.x,n=e=>e.y,r="center",l=()=>5,o="vertical";const s=ke({decorate:()=>{},defined:(a,r)=>L(e,t,n)(a,r),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return s.values=(a,d)=>{const i=l(a,d),c=Ve(r,i),u=s.xScale(),h=s.yScale();if("vertical"===o){const r=h(n(a,d),d),l=h(e(a,d),d),o=u(t(a,d),d)+c;return{d:a,x:o,y:r,y0:l,width:i,height:r-l,origin:[o,r],baseOrigin:[o,l],transposedX:o,transposedY:r}}else{const r=u(n(a,d),d),l=u(e(a,d),d),o=h(t(a,d),d)+c;return{d:a,x:o,y:r,y0:l,width:i,height:r-l,origin:[r,o],baseOrigin:[l,o],transposedX:r,transposedY:o}}},s.xValues=()=>"vertical"===o?[t]:[e,n],s.yValues=()=>"vertical"===o?[e,n]:[t],s.baseValue=(...t)=>t.length?(e=Ae(t[0]),s):e,s.crossValue=(...e)=>e.length?(t=Ae(e[0]),s):t,s.mainValue=(...e)=>e.length?(n=Ae(e[0]),s):n,s.bandwidth=(...e)=>e.length?(l=Ae(e[0]),s):l,s.align=(...e)=>e.length?(r=e[0],s):r,s.orient=(...e)=>e.length?(o=e[0],s):o,s};var Ie={red:"#c60",green:"#6c0",black:"#000",gray:"#ddd",darkGray:"#999"},_e=()=>{const e=Ee(),t=s.line().x((t,a)=>e.values(t,a).transposedX).y((t,a)=>e.values(t,a).transposedY),a=ue("path","line"),n=n=>{n.selection&&a.transition(n),t.defined(e.defined()),n.each((n,i,r)=>{const l=a(o.select(r[i]),[n]);l.enter().attr("fill","none").attr("stroke",Ie.black),l.attr("d",t),e.decorate()(l,n,i)})};return X(n,e,Z("baseValue","bandwidth","align")),q(n,a,"key"),q(n,t,"curve"),n},Te=()=>{const e=Ee(),t=s.line().x((t,a)=>e.values(t,a).transposedX).y((t,a)=>e.values(t,a).transposedY),a=a=>{const n=t.context();n.beginPath(),n.strokeStyle=Ie.black,n.fillStyle="transparent",e.decorate()(n,a),t.defined(e.defined())(a),n.fill(),n.stroke(),n.closePath()};return X(a,e,Z("baseValue","bandwidth","align")),q(a,t,"curve","context"),a},Ne=()=>{let e=[0,1],t=[-1,1];const a=()=>{};return a.domain=(...t)=>t.length?(e=t[0],a):e,a.range=(...e)=>e.length?(t=e[0],a):t,a},Be=()=>{const e={},t={};let a=null;const n=(n,i)=>{const r=n.context();Object.keys(e).forEach(t=>{const a=e[t];if("function"!=typeof a)throw new Error(`Expected an attribute for ${t}, found ${a}`);const l=r.getAttribLocation(i,t);a.location(l)(n)}),Object.keys(t).forEach(e=>{const a=t[e];if("function"!=typeof a)throw new Error(`Expected a uniform for ${e}, found ${a}`);const l=r.getUniformLocation(i,e);a.location(l)(n)}),null!==a&&a(n)};return n.flush=()=>{Object.values(e).forEach(e=>e.clear()),Object.values(t).forEach(e=>e.clear()),null!==a&&a.clear()},n.attribute=(...t)=>1===t.length?e[t[0]]:(e[t[0]]=t[1],n),n.uniform=(...e)=>1===e.length?t[e[0]]:(t[e[0]]=e[1],n),n.elementIndices=(...e)=>e.length?(a=e[0],n):a,n},Re=e=>{let t=-1,a=e,n=!0;const i=e=>{if(n){const i=e.context();if(Array.isArray(a))switch(a.length){case 1:i.uniform1fv(t,a);break;case 2:i.uniform2fv(t,a);break;case 3:i.uniform3fv(t,a);break;case 4:i.uniform4fv(t,a);break;default:throw new Error(`Uniform supports up to 4 elements. ${a.length} provided.`);}else i.uniform1f(t,a);n=!1}};return i.clear=()=>{n=!0},i.location=(...e)=>e.length?(t!==e[0]&&(t=e[0],n=!0),i):t,i.data=(...e)=>e.length?(a=e[0],n=!0,i):a,i},ze={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Pe=()=>{function e(e,t,a){return!e||g||t!==d||a!==o}function t(e,t){const i=a(e,n.VERTEX_SHADER),r=a(t,n.FRAGMENT_SHADER),l=n.createProgram();if(n.attachShader(l,i),n.attachShader(l,r),n.linkProgram(l),u&&!n.getProgramParameter(l,n.LINK_STATUS)){const a=n.getProgramInfoLog(l);throw n.deleteProgram(l),new Error(`Failed to link program : ${a}
            Vertex Shader : ${e}
            Fragment Shader : ${t}`)}return l}function a(e,t){const a=n.createShader(t);if(n.shaderSource(a,e),n.compileShader(a),u&&!n.getShaderParameter(a,n.COMPILE_STATUS)){const t=n.getShaderInfoLog(a);throw n.deleteShader(a),new Error(`Failed to compile shader : ${t}
            Shader : ${e}`)}return a}let n=null,i=null,r=null,l=null,d=null,o=null,s=ze.TRIANGLES,c=Be(),u=!1,h=null,g=!0;const f=a=>{if(null==n)return;const u=r(),p=l();switch(e(i,u,p)&&(i=t(u,p),d=u,o=p,g=!1),n.useProgram(i),c.uniform("uScreen",Re([n.canvas.width,n.canvas.height])),c(f,i),s){case ze.TRIANGLES:{if(null==c.elementIndices())throw new Error("Element indices must be provided.");h.drawElementsInstancedANGLE(s,c.elementIndices().data().length,n.UNSIGNED_SHORT,0,a);break}case ze.POINTS:{if(null!=c.elementIndices())throw new Error("Element indices must not be provided.");n.drawArrays(s,0,a);break}default:throw new Error(`Unsupported drawing mode ${s}.`);}};return f.extInstancedArrays=()=>s===ze.TRIANGLES?h:null,f.context=(...e)=>e.length?((null==e[0]||e[0]!==n)&&(c.flush(),g=!0),null!=e[0]&&e[0]!==n&&(h=e[0].getExtension("ANGLE_instanced_arrays")),n=e[0],f):n,f.buffers=(...e)=>e.length?(c=e[0],f):c,f.vertexShader=(...e)=>e.length?(r=e[0],f):r,f.fragmentShader=(...e)=>e.length?(l=e[0],f):l,f.mode=(...e)=>e.length?(s=e[0],f):s,f.debug=(...e)=>e.length?(u=e[0],f):u,f},De=e=>{function t(e,t){e.push(t)}function a(e,t,a){const n=e.indexOf(a);e.splice(0<=n?n:e.length,0,t)}function n(e,t){const a=e.indexOf(t);-1===a&&e.push(t)}const i=[],r=[],l=()=>e(i.join("\n"),r.join("\n"));return l.appendHeader=e=>(t(i,e),l),l.insertHeader=(e,t)=>(a(i,e,t),l),l.appendHeaderIfNotExists=e=>(n(i,e),l),l.appendBody=e=>(t(r,e),l),l.insertBody=(e,t)=>(a(r,e,t),l),l.appendBodyIfNotExists=e=>(n(r,e),l),l};const Le=(e,t)=>`
precision mediump float;
float inf = 1.0 / 0.0;
${e}
void main() {
    ${t}
}`,Ce=(e,t)=>`
precision mediump float;
${e}
void main() {
    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
    ${t}
}`,He={header:`attribute vec4 aFillColor;
             varying vec4 vFillColor;`,body:`vFillColor = aFillColor;`},Oe={header:`attribute vec4 aStrokeColor;
             varying vec4 vStrokeColor;`,body:`vStrokeColor = aStrokeColor;`},Ge={header:`
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aSize;
        attribute float aDefined;

        uniform float uStrokeWidth;

        varying float vSize;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vSize = 2.0 * sqrt(aSize / 3.14159);
        gl_PointSize = vSize + uStrokeWidth + 1.0;
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);`},Ue={header:`
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aSize;
        attribute float aDefined;

        uniform float uStrokeWidth;

        varying float vSize;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vSize = sqrt(aSize);
        gl_PointSize = vSize + uStrokeWidth + 1.0;
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);`},Fe={header:`
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aSize;
        attribute float aDefined;

        uniform float uStrokeWidth;

        varying float vSize;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vSize = sqrt(aSize);
        gl_PointSize = 2.0 * (vSize + uStrokeWidth + 1.0);
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);`},Me={header:`
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aSize;
        attribute float aDefined;

        uniform float uStrokeWidth;

        varying float vSize;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vSize = sqrt((16.0 * aSize) / (3.0 * sqrt(3.0)));
        gl_PointSize = vSize + uStrokeWidth + 1.0;
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);`},Ye={header:`
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aSize;
        attribute float aDefined;

        uniform float uStrokeWidth;

        varying float vSize;
        varying float vStrokeWidthRatio;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vSize = 3.0 * sqrt(aSize / 5.0);
        vStrokeWidthRatio = uStrokeWidth / (vSize + uStrokeWidth + 1.0);
        gl_PointSize = vSize + uStrokeWidth + 1.0;
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);`},We={header:`
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aHighValue;
        attribute float aOpenValue;
        attribute float aCloseValue;
        attribute float aLowValue;
        attribute vec3 aCorner;
        attribute float aDefined;

        uniform vec2 uScreen;
        uniform float uStrokeWidth;

        varying float vColorIndicator;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vColorIndicator = sign(aCloseValue - aOpenValue);

        float isPositiveY = (sign(aCorner.y) + 1.0) / 2.0;
        float isNotPositiveY = 1.0 - isPositiveY;
        float isExtremeY = abs(aCorner.y) - 1.0;
        float isNotExtremeY = 1.0 - isExtremeY;
        float yValue =
         (isPositiveY * isExtremeY * aLowValue) +
         (isPositiveY * isNotExtremeY * aCloseValue) +
         (isNotPositiveY * isNotExtremeY * aOpenValue) +
         (isNotPositiveY * isExtremeY * aHighValue);

        float lineWidthXDirection = (isNotExtremeY * aCorner.x) + (isExtremeY * aCorner.z);
        float lineWidthYDirection = isNotExtremeY * sign(aCloseValue - aOpenValue) * aCorner.y;

        float bandwidthModifier = aBandwidth * aCorner.x / 2.0;

        float xModifier = (uStrokeWidth * lineWidthXDirection / 2.0) + bandwidthModifier;
        float yModifier = uStrokeWidth * lineWidthYDirection / 2.0;

        gl_Position = vec4(aCrossValue, yValue, 0, 1);`},Qe={header:`
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aHighValue;
        attribute float aOpenValue;
        attribute float aCloseValue;
        attribute float aLowValue;
        attribute vec3 aCorner;
        attribute float aDefined;

        uniform vec2 uScreen;
        uniform float uStrokeWidth;

        varying float vColorIndicator;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vColorIndicator = sign(aCloseValue - aOpenValue);

        float isPositiveY = (sign(aCorner.y) + 1.0) / 2.0;
        float isNotPositiveY = 1.0 - isPositiveY;
        float isExtremeY = abs(aCorner.y) - 1.0;
        float isNotExtremeY = 1.0 - isExtremeY;
        float yValue =
            (isPositiveY * isExtremeY * aLowValue) +
            (isPositiveY * isNotExtremeY * aCloseValue) +
            (isNotPositiveY * isNotExtremeY * aOpenValue) +
            (isNotPositiveY * isExtremeY * aHighValue);

        float lineWidthXDirection = isExtremeY * aCorner.z;
        float lineWidthYDirection = isNotExtremeY * aCorner.z;

        float bandwidthModifier = isNotExtremeY * aCorner.x * aBandwidth / 2.0;

        float xModifier = (uStrokeWidth * lineWidthXDirection / 2.0) + bandwidthModifier;
        float yModifier = uStrokeWidth * lineWidthYDirection / 2.0;

        gl_Position = vec4(aCrossValue, yValue, 0, 1);`},qe={header:`
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aMainValue;
        attribute float aBaseValue;
        attribute vec2 aCorner;
        attribute float aDefined;

        uniform vec2 uScreen;
        uniform float uStrokeWidth;

        varying float vDefined;`,body:`
        vDefined = aDefined;
        float isBaseline = (1.0 - aCorner.y) / 2.0;
        float yValue = (isBaseline * aBaseValue) + ((1.0 - isBaseline) * aMainValue);

        float xModifier = aCorner.x * (aBandwidth) / 2.0;

        gl_Position = vec4(aCrossValue, yValue, 0, 1);`},je={header:`
        attribute vec3 aCorner;
        attribute float aCrossNextNextValue;
        attribute float aMainNextNextValue;
        attribute float aCrossNextValue;
        attribute float aMainNextValue;
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aCrossPrevValue;
        attribute float aMainPrevValue;
        attribute float aDefined;
        attribute float aDefinedNext;

        uniform float uStrokeWidth;
        uniform vec2 uScreen;

        varying float vDefined;`,body:`
        vDefined = aDefined * aDefinedNext;
        vec4 prev = vec4(aCrossPrevValue, aMainPrevValue, 0, 0);
        vec4 curr = vec4(aCrossValue, aMainValue, 0, 0);
        gl_Position = vec4(aCrossNextValue, aMainNextValue, 0, 1);
        vec4 nextNext = vec4(aCrossNextNextValue, aMainNextNextValue, 0, 0);`},Xe={body:`
        vec4 currVertexPosition = gl_Position;
        vec4 nextVertexPosition = gl_Position;

        if (all(equal(curr.xy, prev.xy))) {
            prev.xy = curr.xy + normalize(curr.xy - currVertexPosition.xy);
        }
        if (all(equal(curr.xy, currVertexPosition.xy))) {
            currVertexPosition.xy = curr.xy + normalize(curr.xy - prev.xy);
        }
        vec2 A = normalize(normalize(curr.xy - prev.xy) * uScreen);
        vec2 B = normalize(normalize(currVertexPosition.xy - curr.xy) * uScreen);
        vec2 tangent = normalize(A + B);
        vec2 miter = vec2(-tangent.y, tangent.x);
        vec2 normalA = vec2(-A.y, A.x);
        float miterLength = 1.0 / dot(miter, normalA);
        vec2 point = normalize(A - B);
        if (miterLength > 10.0 && sign(aCorner.x * dot(miter, point)) > 0.0) {
            currVertexPosition.xy = curr.xy - (aCorner.x * aCorner.y * uStrokeWidth * normalA) / uScreen.xy;
        } else {
            currVertexPosition.xy = curr.xy + (aCorner.x * miter * uStrokeWidth * miterLength) / uScreen.xy;
        }

        if (all(equal(nextVertexPosition.xy, curr.xy))) {
            curr.xy = nextVertexPosition.xy + normalize(nextVertexPosition.xy - nextNext.xy);
        }
        if (all(equal(nextVertexPosition.xy, nextNext.xy))) {
            nextNext.xy = nextVertexPosition.xy + normalize(nextVertexPosition.xy - curr.xy);
        }
        vec2 C = normalize(normalize(nextVertexPosition.xy - curr.xy) * uScreen);
        vec2 D = normalize(normalize(nextNext.xy - nextVertexPosition.xy) * uScreen);
        vec2 tangentCD = normalize(C + D);
        vec2 miterCD = vec2(-tangentCD.y, tangentCD.x);
        vec2 normalC = vec2(-C.y, C.x);
        float miterCDLength = 1.0 / dot(miterCD, normalC);
        vec2 pointCD = normalize(C - D);
        if (miterCDLength > 10.0 && sign(aCorner.x * dot(miterCD, pointCD)) > 0.0) {
            nextVertexPosition.xy = nextVertexPosition.xy - (aCorner.x * aCorner.y * uStrokeWidth * normalC) / uScreen.xy;
        } else {
            nextVertexPosition.xy = nextVertexPosition.xy + (aCorner.x * miterCD * uStrokeWidth * miterCDLength) / uScreen.xy;
        }

        gl_Position.xy = ((1.0 - aCorner.z) * currVertexPosition.xy) + (aCorner.z * nextVertexPosition.xy);`},Ke={header:`
        attribute vec3 aCorner;
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aHighValue;
        attribute float aLowValue;
        attribute float aDefined;

        uniform vec2 uScreen;
        uniform float uStrokeWidth;

        varying float vDefined;`,body:`
        vDefined = aDefined;
        float isLow = (aCorner.y + 1.0) / 2.0;
        float yValue = isLow * aLowValue + (1.0 - isLow) * aHighValue;

        float isEdgeCorner = abs(aCorner.x);
        float lineWidthXDirection = (1.0 - isEdgeCorner) * aCorner.z;
        float lineWidthYDirection = isEdgeCorner * aCorner.z;

        gl_Position = vec4(aCrossValue, yValue, 0, 1);

        float xModifier = (uStrokeWidth * lineWidthXDirection) + (aBandwidth * aCorner.x / 2.0);
        float yModifier = (uStrokeWidth * lineWidthYDirection);`},Ze={header:`
        attribute vec3 aCorner;
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aCrossNextValue;
        attribute float aMainNextValue;
        attribute float aBaseValue;
        attribute float aBaseNextValue;
        attribute float aDefined;
        attribute float aDefinedNext;

        varying float vDefined;

        float when_lt(float a, float b) {
            return max(sign(b - a), 0.0);
        }

        float and(float a, float b) {
            return a * b;
        }`,body:`
        vDefined = aDefined * aDefinedNext;
        gl_Position = vec4(0, 0, 0, 1);

        float hasIntercepted = when_lt((aMainNextValue - aBaseNextValue) * (aMainValue - aBaseValue), 0.0);
        float useIntercept = and(aCorner.z, hasIntercepted);

        float yGradient = (aMainNextValue - aMainValue) / (aCrossNextValue - aCrossValue);
        float yConstant = aMainNextValue - (yGradient * aCrossNextValue);

        float y0Gradient = (aBaseNextValue - aBaseValue) / (aCrossNextValue - aCrossValue);
        float y0Constant = aBaseNextValue - (y0Gradient * aCrossNextValue);

        float denominator = (yGradient - y0Gradient) + step(abs(yGradient - y0Gradient), 0.0);
        float interceptXValue = (y0Constant - yConstant) / denominator;
        float interceptYValue = (yGradient * interceptXValue) + yConstant;

        gl_Position = vec4(interceptXValue * useIntercept, interceptYValue * useIntercept, 0, 1);

        gl_Position.x += (1.0 - useIntercept) * ((aCorner.x * aCrossNextValue) + ((1.0 - aCorner.x) * aCrossValue));
        gl_Position.y += (1.0 - useIntercept) * (1.0 - aCorner.y) * ((aCorner.x * aMainNextValue) + ((1.0 - aCorner.x) * aMainValue));
        gl_Position.y += (1.0 - useIntercept) * aCorner.y * ((aCorner.x * aBaseNextValue) + ((1.0 - aCorner.x) * aBaseValue));`},Je={header:`
        attribute vec4 aCorner;
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aCapWidth;
        attribute float aHighValue;
        attribute float aUpperQuartileValue;
        attribute float aMedianValue;
        attribute float aLowerQuartileValue;
        attribute float aLowValue;
        attribute float aDefined;

        uniform vec2 uScreen;
        uniform float uStrokeWidth;

        varying float vDefined;
    `,body:`
        vDefined = aDefined;
        float isExtremeY = sign(abs(aCorner.y) - 2.0) + 1.0;
        float isNotExtremeY = 1.0 - isExtremeY;

        float isNonZeroY = abs(sign(aCorner.y));
        float isZeroY = 1.0 - isNonZeroY;

        float isQuartileY = isNotExtremeY * isNonZeroY;

        float isPositiveY = (sign(aCorner.y + 0.5) + 1.0) / 2.0;
        float isNegativeY = 1.0 - isPositiveY;

        float yValue =
          (isExtremeY * isNegativeY) * aHighValue +
          (isQuartileY * isNegativeY) * aUpperQuartileValue +
          isZeroY * aMedianValue +
          (isQuartileY * isPositiveY) * aLowerQuartileValue +
          (isExtremeY * isPositiveY) * aLowValue;

        gl_Position = vec4(aCrossValue, yValue, 0, 1);

        float isHorizontal = aCorner.w;
        float isVertical = 1.0 - isHorizontal;

        float xDisplacement = aCorner.x * (isExtremeY * aCapWidth + isNotExtremeY * aBandwidth) / 2.0;

        float xModifier = (isVertical * uStrokeWidth * aCorner.z / 2.0) + xDisplacement;
        float yModifier = isHorizontal * uStrokeWidth * aCorner.z / 2.0;`},$e={header:`
        varying float vSize;
        varying float vDefined;`,body:`
        float canFill = 1.0;
        float distance = length(2.0 * gl_PointCoord - 1.0);
        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);
        if (distance > 1.0 || vDefined < 0.5) {
            discard;
            return;
        }`},et={header:`
        varying float vSize;
        varying float vDefined;`,body:`
        float canFill = 1.0;
        if (vDefined < 0.5) {
            discard;
        }
        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;
        float distance = max(abs(pointCoordTransform.x), abs(pointCoordTransform.y));
        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);`},tt={header:`
        varying float vSize;
        varying float vDefined;
        float a = 0.6;
        float b = 1.0;
    `,body:`
        if (vDefined < 0.5) {
            discard;
        }

        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;

        float x = abs(pointCoordTransform.x);
        float y = abs(pointCoordTransform.y);

        float X = (a * b * x) / (a * y + b * x);
        float Y = (a * b * y) / (a * y + b * x);

        float distance = length(vec2(x, y)) / length(vec2(X, Y));

        if (distance > 1.0) {
            discard;
        }
    `},at={header:`
        varying float vSize;
        varying float vDefined;`,body:`
        float canFill = 1.0;
        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;
        float topEdgesDistance = abs(pointCoordTransform.x) - ((pointCoordTransform.y - 0.6) / sqrt(3.0));
        float bottomEdgeDistance = pointCoordTransform.y + 0.5;
        float distance = max(topEdgesDistance, bottomEdgeDistance);
        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);
        if (distance > 1.0 || vDefined < 0.5) {
            discard;
        }`},nt={header:`
        varying float vSize;
        varying float vStrokeWidthRatio;
        varying float vDefined;`,body:`
        float canFill = 1.0;
        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;
        float innerCornerDistance = min(abs(pointCoordTransform.x), abs(pointCoordTransform.y)) + 0.66 - vStrokeWidthRatio;
        float outerEdgeDistance = max(abs(pointCoordTransform.x), abs(pointCoordTransform.y));
        float distance = max(innerCornerDistance, outerEdgeDistance);
        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);
        if (distance > 1.0 || vDefined < 0.5) {
            discard;
        }`},it={header:`
        varying float vColorIndicator;
        varying float vDefined;`,body:`
        float canFill = 1.0;
        float canStroke = 0.0;
        if (vDefined < 0.5) {
            discard;
        }
        gl_FragColor = vec4(0.4, 0.8, 0, 1);
        if (vColorIndicator < 0.0) {
            gl_FragColor = vec4(0.8, 0.4, 0, 1);
        }`},rt={header:`
        varying float vColorIndicator;
        varying float vDefined;`,body:`
        float canFill = 0.0;
        float canStroke = 1.0;
        if (vDefined < 0.5) {
            discard;
        }
        gl_FragColor = vec4(0.4, 0.8, 0, 1);
        if (vColorIndicator < 0.0) {
            gl_FragColor = vec4(0.8, 0.4, 0, 1);
        }`},lt={header:`
        varying float vDefined;`,body:`
        float canFill = 1.0;
        float canStroke = 0.0;
        if (vDefined < 0.5) {
            discard;
        }
        gl_FragColor = vec4(0.86, 0.86, 0.86, 1);`},dt={header:`
        varying float vDefined;
    `,body:`
        float canFill = 0.0;
        float canStroke = 1.0;

        if (vDefined < 0.5) {
            discard;
        }`},ot={header:`varying float vDefined;`,body:`
        float canFill = 0.0;
        float canStroke = 1.0;
        if (vDefined < 0.5) {
            discard;
        }`},st={header:`varying float vDefined;`,body:`
        float canFill = 1.0;
        float canStroke = 0.0;

        gl_FragColor = vec4(0.60, 0.60, 0.60, 1.0);

        if (vDefined < 0.5) {
            discard;
        }`},ct={header:`varying vec4 vFillColor;`,body:`gl_FragColor = (canFill * vFillColor) + ((1.0 - canFill) * gl_FragColor);`},ut={header:`varying vec4 vStrokeColor;`,body:`gl_FragColor = (canStroke * vStrokeColor) + ((1.0 - canStroke) * gl_FragColor);`},ht={header:`varying float vDefined;`,body:`
        float canFill = 0.0;
        float canStroke = 1.0;
        if (vDefined < 0.5) {
            discard;
        }`};var gt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(Ze.header).appendBody(Ze.body),t.appendHeader(lt.header).appendBody(lt.body),{vertex:()=>e,fragment:()=>t}};const ft={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,FLOAT:5126};var pt=()=>{let e=-1,t=null,a=1,n=ft.FLOAT,i=!1,r=0,l=0,d=0;const o=o=>{const s=o.context();null==t&&(t=s.createBuffer()),s.bindBuffer(s.ARRAY_BUFFER,t),s.vertexAttribPointer(e,a,n,i,r,l),s.enableVertexAttribArray(e);const c=o.extInstancedArrays();null!=c&&c.vertexAttribDivisorANGLE(e,d)};return o.location=(...t)=>t.length?(e=t[0],o):e,o.buffer=(...e)=>e.length?(t=e[0],o):t,o.size=(...e)=>e.length?(a=e[0],o):a,o.type=(...e)=>e.length?(n=e[0],o):n,o.normalized=(...e)=>e.length?(i=e[0],o):i,o.stride=(...e)=>e.length?(r=e[0],o):r,o.offset=(...e)=>e.length?(l=e[0],o):l,o.divisor=(...e)=>e.length?(d=e[0],o):d,o},mt=()=>{let e=ft.FLOAT,t=new Float32Array(0);const a=a=>{const n=H(e);return t.length>a?t=new n(t.buffer,0,a):t.length!==a&&(t=new n(a)),t};return a.type=(...n)=>{if(!n.length)return e;if(e!==n[0]){e=n[0];const a=H(e);t=new a(0)}return a},a},bt=()=>{let e=!0,t=1,a=ft.FLOAT,n=mt(),r=e=>e,l=null;const d=()=>{const d=l.length,o=n.type(a)(d*t);if(1<t)for(let e=0;e<d;e++){const a=r(l[e],e);if(a.length!==t)throw new Error(`Expected components array of size ${t}, recieved array with length ${a.length}.`);for(let n=0;n<t;n++)o[e*t+n]=a[n]}else for(let e=0;e<d;e++){const t=r(l[e],e);if(Array.isArray(t))throw new Error(`Expected a single component value, recieved array with length ${t.length}.`);o[e]=t}return e=!1,o};return d.dirty=()=>e,d.clear=()=>{e=!0},d.size=(...a)=>a.length?(t=a[0],e=!0,d):t,d.type=(...t)=>t.length?(a=t[0],e=!0,d):a,d.arrayViewFactory=(...t)=>t.length?(n=t[0],e=!0,d):n,d.value=(...t)=>t.length?(r=t[0],e=!0,d):r,d.data=(...t)=>t.length?(l=t[0],e=!0,d):l,d},yt=()=>{const e=pt(),t=bt(),a=n=>{if(e.size(a.size()).type(a.type()),e(n),!t.dirty())return;const i=t(),r=n.context();r.bindBuffer(r.ARRAY_BUFFER,e.buffer()),r.bufferData(r.ARRAY_BUFFER,i,r.DYNAMIC_DRAW)};return a.clear=()=>{e.buffer(null),t.clear()},q(a,e,"normalized","location"),q(a,t,"data","value","size","type"),a},xt=e=>{let t=null,a=e,n=!0;const i=e=>{const i=e.context();null==t&&(t=i.createBuffer()),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),n&&(i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),i.STATIC_DRAW),n=!1)};return i.clear=()=>{t=null,n=!0},i.data=(...e)=>e.length?(n=!0,a=e[0],i):a,i},vt=(e,t,a,n,...i)=>{e[t]=(...t)=>{const r=a[n](...i,...t);return r===a?e:r}},St=()=>{const e=Pe().mode(ze.TRIANGLES);let t=Ne(),a=Ne(),n=()=>{};const i=yt().size(3).type(ft.UNSIGNED_BYTE).data([[0,0,0],[0,1,0],[1,1,1],[0,0,1],[1,0,0],[1,1,0]]);e.buffers().elementIndices(xt([0,1,2,3,4,5])).attribute("aCorner",i);const r=i=>{const r=gt();e.vertexShader(r.vertex()).fragmentShader(r.fragment()),t(e,"gl_Position",0),a(e,"gl_Position",1),n(e),e(i-1)};return r.decorate=(...e)=>e.length?(n=e[0],r):n,r.xScale=(...e)=>e.length?(t=e[0],r):t,r.yScale=(...e)=>e.length?(a=e[0],r):a,q(r,e,"context"),vt(r,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),vt(r,"crossNextValueAttribute",e.buffers(),"attribute","aCrossNextValue"),vt(r,"mainValueAttribute",e.buffers(),"attribute","aMainValue"),vt(r,"mainNextValueAttribute",e.buffers(),"attribute","aMainNextValue"),vt(r,"baseValueAttribute",e.buffers(),"attribute","aBaseValue"),vt(r,"baseNextValueAttribute",e.buffers(),"attribute","aBaseNextValue"),vt(r,"definedAttribute",e.buffers(),"attribute","aDefined"),vt(r,"definedNextAttribute",e.buffers(),"attribute","aDefinedNext"),r},wt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(Ge.header).appendBody(Ge.body),t.appendHeader($e.header).appendBody($e.body),{vertex:()=>e,fragment:()=>t}},At=()=>{const e=Pe().mode(ze.POINTS);let t=Ne(),a=Ne(),n=wt(),i=()=>{};const r=r=>{e.vertexShader(n.vertex()).fragmentShader(n.fragment()),t(e,"gl_Position",0),a(e,"gl_Position",1),i(e),e(r)};return r.type=(...e)=>e.length?(n=e[0],r):n,r.decorate=(...e)=>e.length?(i=e[0],r):i,r.xScale=(...e)=>e.length?(t=e[0],r):t,r.yScale=(...e)=>e.length?(a=e[0],r):a,q(r,e,"context"),vt(r,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),vt(r,"mainValueAttribute",e.buffers(),"attribute","aMainValue"),vt(r,"sizeAttribute",e.buffers(),"attribute","aSize"),vt(r,"definedAttribute",e.buffers(),"attribute","aDefined"),r},Vt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(je.header).appendBody(je.body),t.appendHeader(ht.header).appendBody(ht.body),{vertex:()=>e,fragment:()=>t}},kt=()=>{let e=1;const t=t=>{t.buffers().uniform("uStrokeWidth",Re(e))};return t.lineWidth=(...a)=>a.length?(e=a[0],t):e,t},Et=()=>{const e=Pe().mode(ze.TRIANGLES);let t=Ne(),a=Ne(),n=()=>{};const i=kt(),r=yt().size(3).type(ft.BYTE).data([[-1,0,0],[1,1,0],[1,-1,1],[-1,0,1],[1,1,1]]);e.buffers().elementIndices(xt([0,1,2,1,2,3,0,2,3,2,3,4])).attribute("aCorner",r);const l=r=>{const l=Vt();e.vertexShader(l.vertex()).fragmentShader(l.fragment()),t(e,"prev",0),a(e,"prev",1),t(e,"curr",0),a(e,"curr",1),t(e,"gl_Position",0),a(e,"gl_Position",1),t(e,"nextNext",0),a(e,"nextNext",1),e.vertexShader().appendBody(Xe.body),i(e),n(e),e(r-1)};return l.decorate=(...e)=>e.length?(n=e[0],l):n,l.xScale=(...e)=>e.length?(t=e[0],l):t,l.yScale=(...e)=>e.length?(a=e[0],l):a,q(l,e,"context"),q(l,i,"lineWidth"),vt(l,"crossPreviousValueAttribute",e.buffers(),"attribute","aCrossPrevValue"),vt(l,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),vt(l,"crossNextValueAttribute",e.buffers(),"attribute","aCrossNextValue"),vt(l,"crossNextNextValueAttribute",e.buffers(),"attribute","aCrossNextNextValue"),vt(l,"mainPreviousValueAttribute",e.buffers(),"attribute","aMainPrevValue"),vt(l,"mainValueAttribute",e.buffers(),"attribute","aMainValue"),vt(l,"mainNextValueAttribute",e.buffers(),"attribute","aMainNextValue"),vt(l,"mainNextNextValueAttribute",e.buffers(),"attribute","aMainNextNextValue"),vt(l,"definedAttribute",e.buffers(),"attribute","aDefined"),vt(l,"definedNextAttribute",e.buffers(),"attribute","aDefinedNext"),l},It=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(Qe.header).appendBody(Qe.body),t.appendHeader(rt.header).appendBody(rt.body),{vertex:()=>e,fragment:()=>t}},_t=()=>{const e=Pe().mode(ze.TRIANGLES);let t=Ne(),a=Ne();const n=kt();let i=()=>{};const r=yt().size(3).type(ft.BYTE).data([[0,-2,-1],[0,-2,1],[0,2,1],[0,2,-1],[-1,-1,-1],[-1,-1,1],[0,-1,1],[0,-1,-1],[1,1,1],[0,1,1],[0,1,-1],[1,1,-1]]);e.buffers().elementIndices(xt([0,1,2,0,3,2,4,5,6,4,7,6,8,9,10,10,11,8])).attribute("aCorner",r);const l=r=>{const l=It();e.vertexShader(l.vertex()).fragmentShader(l.fragment()),t(e,"gl_Position",0),a(e,"gl_Position",1),n(e),e.vertexShader().appendBody(`
          gl_Position.x += xModifier / uScreen.x;
          gl_Position.y += yModifier / uScreen.y;
        `),i(e),e(r)};return l.decorate=(...e)=>e.length?(i=e[0],l):i,l.xScale=(...e)=>e.length?(t=e[0],l):t,l.yScale=(...e)=>e.length?(a=e[0],l):a,q(l,e,"context"),q(l,n,"lineWidth"),vt(l,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),vt(l,"openValueAttribute",e.buffers(),"attribute","aOpenValue"),vt(l,"highValueAttribute",e.buffers(),"attribute","aHighValue"),vt(l,"lowValueAttribute",e.buffers(),"attribute","aLowValue"),vt(l,"closeValueAttribute",e.buffers(),"attribute","aCloseValue"),vt(l,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),vt(l,"definedAttribute",e.buffers(),"attribute","aDefined"),l},Tt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(qe.header).appendBody(qe.body),t.appendHeader(st.header).appendBody(st.body),{vertex:()=>e,fragment:()=>t}},Nt=()=>{const e=Pe().mode(ze.TRIANGLES);let t=Ne(),a=Ne(),n=()=>{};const i=yt().size(2).type(ft.BYTE).data([[-1,-1],[1,1],[-1,1],[1,-1]]);e.buffers().elementIndices(xt([0,1,2,0,1,3])).attribute("aCorner",i);const r=i=>{const r=Tt();e.vertexShader(r.vertex()).fragmentShader(r.fragment()),t(e,"gl_Position",0),a(e,"gl_Position",1),e.vertexShader().appendBody(`
            gl_Position.x += xModifier / uScreen.x * 2.0;
        `),n(e),e(i)};return r.decorate=(...e)=>e.length?(n=e[0],r):n,r.xScale=(...e)=>e.length?(t=e[0],r):t,r.yScale=(...e)=>e.length?(a=e[0],r):a,q(r,e,"context"),vt(r,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),vt(r,"mainValueAttribute",e.buffers(),"attribute","aMainValue"),vt(r,"baseValueAttribute",e.buffers(),"attribute","aBaseValue"),vt(r,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),vt(r,"definedAttribute",e.buffers(),"attribute","aDefined"),r},Bt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(Ke.header).appendBody(Ke.body),t.appendHeader(ot.header).appendBody(ot.body),{vertex:()=>e,fragment:()=>t}},Rt=()=>{const e=Pe().mode(ze.TRIANGLES);let t=Ne(),a=Ne(),n=()=>{};const i=kt(),r=yt().size(3).type(ft.BYTE).data([[0,1,1],[0,1,-1],[0,-1,-1],[0,-1,1],[1,-1,1],[1,-1,-1],[-1,-1,-1],[-1,-1,1],[-1,1,-1],[-1,1,1],[1,1,1],[1,1,-1]]);e.buffers().elementIndices(xt([0,1,2,0,3,2,4,5,6,4,7,6,8,9,10,8,11,10])).attribute("aCorner",r);const l=r=>{const l=Bt();e.vertexShader(l.vertex()).fragmentShader(l.fragment()),t(e,"gl_Position",0),a(e,"gl_Position",1),i(e),e.vertexShader().appendBody(`
                gl_Position.x += xModifier / uScreen.x * 2.0;
                gl_Position.y += yModifier / uScreen.y * 2.0;
            `),n(e),e(r)};return l.decorate=(...e)=>e.length?(n=e[0],l):n,l.xScale=(...e)=>e.length?(t=e[0],l):t,l.yScale=(...e)=>e.length?(a=e[0],l):a,q(l,e,"context"),q(l,i,"lineWidth"),vt(l,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),vt(l,"highValueAttribute",e.buffers(),"attribute","aHighValue"),vt(l,"lowValueAttribute",e.buffers(),"attribute","aLowValue"),vt(l,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),vt(l,"definedAttribute",e.buffers(),"attribute","aDefined"),l},zt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(We.header).appendBody(We.body),t.appendHeader(it.header).appendBody(it.body),{vertex:()=>e,fragment:()=>t}},Pt=()=>{const e=Pe().mode(ze.TRIANGLES);let t=Ne(),a=Ne();const n=kt();let i=()=>{};const r=yt().size(3).type(ft.BYTE).data([[0,2,1],[0,2,-1],[0,-2,-1],[0,-2,1],[1,-1,0],[-1,-1,0],[-1,1,0],[1,1,0]]);e.buffers().elementIndices(xt([0,1,2,0,3,2,4,5,6,4,7,6])).attribute("aCorner",r);const l=r=>{const l=zt();e.vertexShader(l.vertex()).fragmentShader(l.fragment()),t(e,"gl_Position",0),a(e,"gl_Position",1),n(e),e.vertexShader().appendBody(`
          gl_Position.x += xModifier / uScreen.x;
          gl_Position.y += yModifier / uScreen.y;
        `),i(e),e(r)};return l.decorate=(...e)=>e.length?(i=e[0],l):i,l.xScale=(...e)=>e.length?(t=e[0],l):t,l.yScale=(...e)=>e.length?(a=e[0],l):a,q(l,e,"context"),q(l,n,"lineWidth"),vt(l,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),vt(l,"openValueAttribute",e.buffers(),"attribute","aOpenValue"),vt(l,"highValueAttribute",e.buffers(),"attribute","aHighValue"),vt(l,"lowValueAttribute",e.buffers(),"attribute","aLowValue"),vt(l,"closeValueAttribute",e.buffers(),"attribute","aCloseValue"),vt(l,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),vt(l,"definedAttribute",e.buffers(),"attribute","aDefined"),l},Dt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(Je.header).appendBody(Je.body),t.appendHeader(dt.header).appendBody(dt.body),{vertex:()=>e,fragment:()=>t}},Lt=()=>{const e=Pe().mode(ze.TRIANGLES);let t=Ne(),a=Ne(),n=()=>{};const i=kt(),r=yt().size(4).type(ft.BYTE).data([[-1,-2,-1,1],[1,-2,-1,1],[1,-2,1,1],[-1,-2,1,1],[0,-2,-1,0],[0,-2,1,0],[0,-1,1,0],[0,-1,-1,0],[-1,-1,-1,1],[1,-1,-1,1],[1,-1,1,1],[-1,-1,1,1],[-1,0,-1,1],[1,0,-1,1],[1,0,1,1],[-1,0,1,1],[-1,1,-1,1],[1,1,-1,1],[1,1,1,1],[-1,1,1,1],[-1,-1,-1,0],[-1,-1,1,0],[-1,1,1,0],[-1,1,-1,0],[1,-1,-1,0],[1,-1,1,0],[1,1,1,0],[1,1,-1,0],[0,2,-1,0],[0,2,1,0],[0,1,1,0],[0,1,-1,0],[-1,2,-1,1],[1,2,-1,1],[1,2,1,1],[-1,2,1,1]]);e.buffers().elementIndices(xt([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23,24,25,26,24,26,27,28,29,30,28,30,31,32,33,34,32,34,35])).attribute("aCorner",r);const l=r=>{const l=Dt();e.vertexShader(l.vertex()).fragmentShader(l.fragment()),t(e,"gl_Position",0),a(e,"gl_Position",1),i(e),e.vertexShader().appendBody(`
            gl_Position.x += xModifier / uScreen.x * 2.0;
            gl_Position.y += yModifier / uScreen.y * 2.0;
        `),n(e),e(r)};return l.decorate=(...e)=>e.length?(n=e[0],l):n,l.xScale=(...e)=>e.length?(t=e[0],l):t,l.yScale=(...e)=>e.length?(a=e[0],l):a,q(l,e,"context"),q(l,i,"lineWidth"),vt(l,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),vt(l,"highValueAttribute",e.buffers(),"attribute","aHighValue"),vt(l,"upperQuartileValueAttribute",e.buffers(),"attribute","aUpperQuartileValue"),vt(l,"medianValueAttribute",e.buffers(),"attribute","aMedianValue"),vt(l,"lowerQuartileValueAttribute",e.buffers(),"attribute","aLowerQuartileValue"),vt(l,"lowValueAttribute",e.buffers(),"attribute","aLowValue"),vt(l,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),vt(l,"capAttribute",e.buffers(),"attribute","aCapWidth"),vt(l,"definedAttribute",e.buffers(),"attribute","aDefined"),l},Ct=(e=0,t=0)=>{if(0<e||0>t)throw new Error(`Offset values (${e} & ${t}) must straddle 0 `);const a=pt().divisor(1),n=bt(),i=r=>{const l=i.size()*C(i.type()),d=W(e)*l;if(a.offset(d).size(i.size()).type(i.type()),a(r),!n.dirty())return;const o=n(),s=d+o.length*C(i.type())+t*l,c=r.context();c.bindBuffer(c.ARRAY_BUFFER,a.buffer()),c.bufferData(c.ARRAY_BUFFER,s,c.DYNAMIC_DRAW),c.bufferSubData(c.ARRAY_BUFFER,d,o)};return i.offset=n=>{if(e>n||n>t)throw new Error(`Requested offset ${n} exceeds bounds (${e} & ${t}) `);const r=t=>{a.offset((n-e)*i.size()*C(i.type())),a(t)};return q(r,a,"location"),q(r,i,"clear"),r},i.clear=()=>{a.buffer(null),n.clear()},q(i,a,"normalized","location"),q(i,n,"data","value","size","type"),i},Ht=()=>{const e=pt().divisor(1),t=bt(),a=n=>{if(e.size(a.size()).type(a.type()),e(n),!t.dirty())return;const i=t(),r=n.context();r.bindBuffer(r.ARRAY_BUFFER,e.buffer()),r.bufferData(r.ARRAY_BUFFER,i,r.DYNAMIC_DRAW)};return a.clear=()=>{e.buffer(null),t.clear()},q(a,e,"normalized","location"),q(a,t,"data","value","size","type"),a},Ot=()=>{const e=Ne(),t=e=>`linear${e}`,a=(a,n,i)=>{a.vertexShader().appendHeaderIfNotExists(`uniform vec4 ${t(i)}Offset;`).appendHeaderIfNotExists(`uniform vec4 ${t(i)}Scale;`).appendBody(`${n} = ${n} + ${t(i)}Offset;`).appendBody(`${n} = ${n} * ${t(i)}Scale;`);const r=e.domain()[1]-e.domain()[0],l=e.range()[1]-e.range()[0],d=e.range()[0]*(r/l)-e.domain()[0],o=[0,0,0,0],s=[1,1,1,1];o[i]=d,s[i]=l/r,a.buffers().uniform(`${t(i)}Offset`,Re(o)).uniform(`${t(i)}Scale`,Re(s))};return X(a,e),a},Gt=()=>{function e(e,t){var a=Math.log10;return a(e)/a(t)}const t=Ne();let a=10;const n=e=>`log${e}`,i=(i,r,l)=>{const d=`${n(l)}Offset + (${n(l)}Scale * clamp(log(${r}) / log(${n(l)}Base), -inf, inf))`;i.vertexShader().appendHeaderIfNotExists(`uniform vec4 ${n(l)}Offset;`).appendHeaderIfNotExists(`uniform vec4 ${n(l)}Scale;`).appendHeaderIfNotExists(`uniform vec4 ${n(l)}Include;`).appendHeaderIfNotExists(`uniform float ${n(l)}Base;`).appendBody(`${r} = (${n(l)}Include * (${d})) + ((1.0 - ${n(l)}Include) * ${r});`);const o=e(t.domain()[1],a)-e(t.domain()[0],a),s=t.range()[1]-t.range()[0],c=s/o,u=t.range()[0]-c*e(t.domain()[0],a),h=[0,0,0,0],g=[0,0,0,0],f=[0,0,0,0];h[l]=u,g[l]=c,f[l]=1,i.buffers().uniform(`${n(l)}Offset`,Re(h)).uniform(`${n(l)}Scale`,Re(g)).uniform(`${n(l)}Include`,Re(f)).uniform(`${n(l)}Base`,Re(a))};return i.base=(...e)=>e.length?(a=e[0],i):a,X(i,t),i},Ut=()=>{function e(t,a){var e=Math.pow,n=Math.sign;return n(t)*e(W(t),a)}const t=Ne();let a=1;const n=e=>`pow${e}`,i=(i,r,l)=>{const d=`${n(l)}Offset + (${n(l)}Scale * sign(${r}) * pow(abs(${r}), vec4(${n(l)}Exp)))`;i.vertexShader().appendHeaderIfNotExists(`uniform vec4 ${n(l)}Offset;`).appendHeaderIfNotExists(`uniform vec4 ${n(l)}Scale;`).appendHeaderIfNotExists(`uniform vec4 ${n(l)}Include;`).appendHeaderIfNotExists(`uniform float ${n(l)}Exp;`).appendBody(`${r} = (${n(l)}Include * (${d})) + ((1.0 - ${n(l)}Include) * ${r});`);const o=e(t.domain()[1],a)-e(t.domain()[0],a),s=t.range()[1]-t.range()[0],c=s/o,u=t.range()[0]-c*e(t.domain()[0],a),h=[0,0,0,0],g=[0,0,0,0],f=[0,0,0,0];h[l]=u,g[l]=c,f[l]=1,i.buffers().uniform(`${n(l)}Offset`,Re(h)).uniform(`${n(l)}Scale`,Re(g)).uniform(`${n(l)}Include`,Re(f)).uniform(`${n(l)}Exp`,Re(a))};return i.exponent=(...e)=>e.length?(a=e[0],i):a,X(i,t),i};const Ft=a.scaleLinear().copy.toString(),Mt=a.scaleLog().copy.toString(),Yt=a.scalePow().copy.toString(),Wt=a.scaleTime().copy.toString(),Qt=a.scaleIdentity();var qt=e=>{switch(e.copy.toString()){case Ft:case Wt:return{scale:Qt,webglScale:Ot().domain(e.domain())};case Mt:return{scale:Qt,webglScale:Gt().domain(e.domain()).base(e.base())};case Yt:return{scale:Qt,webglScale:Ut().domain(e.domain()).exponent(e.exponent())};default:return{scale:e.copy(),webglScale:Ot().domain(e.range())};}},jt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(Ue.header).appendBody(Ue.body),t.appendHeader(et.header).appendBody(et.body),{vertex:()=>e,fragment:()=>t}},Xt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(Me.header).appendBody(Me.body),t.appendHeader(at.header).appendBody(at.body),{vertex:()=>e,fragment:()=>t}},Kt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(Ye.header).appendBody(Ye.body),t.appendHeader(nt.header).appendBody(nt.body),{vertex:()=>e,fragment:()=>t}},Zt=()=>{const e=De(Le),t=De(Ce);return e.appendHeader(Fe.header).appendBody(Fe.body),t.appendHeader(tt.header).appendBody(tt.body),{vertex:()=>e,fragment:()=>t}},Jt=e=>{switch(e){case s.symbolCircle:return wt();case s.symbolSquare:return jt();case s.symbolTriangle:return Xt();case s.symbolCross:return Kt();case s.symbolDiamond:return Zt();default:throw new Error(`Unrecognised symbol: ${e}`);}},$t=e=>{const t=pt().divisor(1);let a=e,n=!0;const i=e=>{if(t(e),!!n){if(!Array.isArray(a))throw new Error(`Expected an array, received: ${a}`);if(a.length!==t.size())throw new Error(`Expected array of length: ${t.size()}, recieved array of length: ${a.length}`);const i=e.context();i[`vertexAttrib${a.length}fv`](t.location(),a),i.disableVertexAttribArray(t.location()),n=!1}};return i.clear=()=>{n=!0},i.value=(...e)=>e.length?(a=e[0],n=!0,i):a,q(i,t,"normalized","size","location"),i},ea=()=>{const e=s.symbol(),t=Ee(),a=ue("g","point"),n=e=>"translate("+e[0]+", "+e[1]+")",i=i=>{i.selection&&a.transition(i),i.each((i,r,l)=>{const d=i.filter(t.defined()),s=a(o.select(l[r]),d);s.enter().attr("transform",(e,a)=>n(t.values(e,a).origin)).attr("fill",Ie.gray).attr("stroke",Ie.black).append("path"),s.attr("transform",(e,a)=>n(t.values(e,a).origin)).select("path").attr("d",e),t.decorate()(s,i,r)})};return X(i,t,Z("baseValue","bandwidth","align")),q(i,a,"key"),q(i,e,"type","size"),i},ta=()=>{const e=s.symbol(),t=Ee(),a=a=>{const n=a.filter(t.defined()),r=e.context();n.forEach((a,n)=>{r.save();const i=t.values(a,n);r.translate(i.origin[0],i.origin[1]),r.beginPath(),r.strokeStyle=Ie.black,r.fillStyle=Ie.gray,t.decorate()(r,a,n),e(a,n),r.fill(),r.stroke(),r.closePath(),r.restore()})};return X(a,t,Z("baseValue","bandwidth","align")),q(a,e,"size","type","context"),a},aa=()=>{let e=e=>e.high,t=e=>e.low,n=e=>e.cross,r="vertical",l="center",o=()=>5;const s=ke({decorate:()=>{},defined:(a,r)=>L(t,e,n)(a,r),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return s.values=(a,d)=>{const i=o(a,d),c=Ve(l,i),u=s.xScale(),h=s.yScale();if("vertical"===r){const r=h(e(a,d));return{origin:[u(n(a,d))+c,r],high:0,low:h(t(a,d))-r,width:i}}else{const r=u(t(a,d));return{origin:[r,h(n(a,d))+c],high:u(e(a,d))-r,low:0,width:i}}},s.xValues=()=>"vertical"===r?[n]:[e,t],s.yValues=()=>"vertical"===r?[e,t]:[n],s.orient=(...e)=>e.length?(r=e[0],s):r,s.lowValue=(...e)=>e.length?(t=Ae(e[0]),s):t,s.highValue=(...t)=>t.length?(e=Ae(t[0]),s):e,s.crossValue=(...e)=>e.length?(n=Ae(e[0]),s):n,s.bandwidth=(...e)=>e.length?(o=Ae(e[0]),s):o,s.align=(...e)=>e.length?(l=e[0],s):l,s},na=()=>{let e,t=e=>e.date,n=e=>e.open,r=e=>e.high,l=e=>e.low,o=e=>e.close,s=()=>5,c="center",u=(a,n)=>e.xScale()(t(a,n));return e=ke({decorate:()=>{},defined:(e,a)=>L(t,n,l,r,o)(e,a),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()}),e.values=(t,a)=>{const i=o(t,a),d=n(t,a),h=s(t,a),g=Ve(c,h);let f="";return i>d?f="up":i<d&&(f="down"),{cross:u(t,a)+g,open:e.yScale()(d),high:e.yScale()(r(t,a)),low:e.yScale()(l(t,a)),close:e.yScale()(i),width:h,direction:f}},e.xValues=()=>[t],e.yValues=()=>[n,r,l,o],e.crossValue=(...a)=>a.length?(t=a[0],e):t,e.openValue=(...t)=>t.length?(n=t[0],e):n,e.highValue=(...t)=>t.length?(r=t[0],e):r,e.lowValue=(...t)=>t.length?(l=t[0],e):l,e.yValue=e.closeValue=(...t)=>t.length?(o=t[0],e):o,e.bandwidth=(...t)=>t.length?(s=Ae(t[0]),e):s,e.align=(...t)=>t.length?(c=t[0],e):c,e},ia=(e,t)=>{const a=na(),n=ue("g",t),r=e=>"translate("+e.cross+", "+e.high+")",l=e=>t=>e.selection?t.transition(e):t,d=i=>{i.selection&&n.transition(i);const s=l(i);i.each((i,l,d)=>{const c=i.filter(a.defined()),u=n(o.select(d[l]),c);u.enter().attr("transform",(e,t)=>r(a.values(e,t))+" scale(1e-6, 1)").append("path"),u.each((n,l,i)=>{const d=a.values(n,l),c="up"===d.direction?Ie.green:Ie.red,u=s(o.select(i[l])).attr("class",t+" "+d.direction).attr("stroke",c).attr("fill",c).attr("transform",()=>r(d)+" scale(1)");e.x(0).width(d.width).open(()=>d.open-d.high).high(0).low(()=>d.low-d.high).close(()=>d.close-d.high),u.select("path").attr("d",e([n]))}),a.decorate()(u,i,l)})};return q(d,n,"key"),X(d,a),d},ra=e=>{const t=na(),a=a=>{const n=a.filter(t.defined()),r=e.context();n.forEach((a,n)=>{r.save();const i=t.values(a,n);r.translate(i.cross,i.high),r.beginPath(),e.x(0).open(()=>i.open-i.high).width(i.width).high(0).low(()=>i.low-i.high).close(()=>i.close-i.high)([a]);const l="up"===i.direction?Ie.green:Ie.red;r.strokeStyle=l,r.fillStyle=l,t.decorate()(r,a,n),r.fill(),r.stroke(),r.closePath(),r.restore()})};return q(a,e,"context"),X(a,t),a},la=e=>{const t=na(),a=Ht(),n=Ht(),i=Ht(),r=Ht(),l=Ht(),d=Ht().type(ft.UNSIGNED_SHORT),o=Ht().type(ft.UNSIGNED_BYTE);e.crossValueAttribute(a).openValueAttribute(n).highValueAttribute(i).lowValueAttribute(r).closeValueAttribute(l).bandwidthAttribute(d).definedAttribute(o);let s=()=>!1,c=qt,u=[],h=null,g=null;const f=f=>{const p=c(t.xScale()),m=c(t.yScale()),b=!s(u,f);b&&(u=f,d.value((e,a)=>t.bandwidth()(e,a)).data(f),o.value((e,a)=>t.defined()(e,a)).data(f)),(b||p.scale!==h)&&(h=p.scale,a.value((e,a)=>p.scale(t.crossValue()(e,a))).data(f)),(b||m.scale!==g)&&(g=m.scale,n.value((e,a)=>m.scale(t.openValue()(e,a))).data(f),i.value((e,a)=>m.scale(t.highValue()(e,a))).data(f),r.value((e,a)=>m.scale(t.lowValue()(e,a))).data(f),l.value((e,a)=>m.scale(t.closeValue()(e,a))).data(f)),e.xScale(p.webglScale).yScale(m.webglScale).decorate(e=>t.decorate()(e,f,0)),e(f.length)};return f.equals=(...e)=>e.length?(s=e[0],f):s,f.scaleMapper=(...e)=>e.length?(c=e[0],f):c,X(f,t,Z("align")),q(f,e,"context","lineWidth"),f},da=()=>{let e=e=>e.upperQuartile,t=e=>e.lowerQuartile,n=e=>e.high,r=e=>e.low,l=e=>e.value,o=e=>e.median,s="vertical",c="center",u=()=>5;const h=ke({decorate:()=>{},defined:(a,d)=>L(r,n,t,e,l,o)(a,d),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return h.values=(a,d)=>{const i=u(a,d),g=Ve(c,i),f=h.xScale(),p=h.yScale();if("vertical"===s){const s=p(n(a,d));return{origin:[f(l(a,d))+g,s],high:0,upperQuartile:p(e(a,d))-s,median:p(o(a,d))-s,lowerQuartile:p(t(a,d))-s,low:p(r(a,d))-s,width:i}}else{const s=f(r(a,d));return{origin:[s,p(l(a,d))+g],high:f(n(a,d))-s,upperQuartile:f(e(a,d))-s,median:f(o(a,d))-s,lowerQuartile:f(t(a,d))-s,low:0,width:i}}},h.xValues=()=>"vertical"===s?[l]:[e,t,n,r,o],h.yValues=()=>"vertical"===s?[e,t,n,r,o]:[l],h.orient=(...e)=>e.length?(s=e[0],h):s,h.lowerQuartileValue=(...e)=>e.length?(t=Ae(e[0]),h):t,h.upperQuartileValue=(...t)=>t.length?(e=Ae(t[0]),h):e,h.lowValue=(...e)=>e.length?(r=Ae(e[0]),h):r,h.highValue=(...e)=>e.length?(n=Ae(e[0]),h):n,h.crossValue=(...e)=>e.length?(l=Ae(e[0]),h):l,h.medianValue=(...e)=>e.length?(o=Ae(e[0]),h):o,h.bandwidth=(...e)=>e.length?(u=Ae(e[0]),h):u,h.align=(...e)=>e.length?(c=e[0],h):c,h},oa=()=>{let e=[],t=e=>e,n=(e,t)=>t;const i=ke({decorate:()=>{},xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return i.xValues=()=>e.map(e=>e.xValues()).reduce((e,t)=>e.concat(t)),i.yValues=()=>e.map(e=>e.yValues()).reduce((e,t)=>e.concat(t)),i.mapping=(...e)=>e.length?(t=e[0],i):t,i.key=(...e)=>e.length?(n=e[0],i):n,i.series=(...t)=>t.length?(e=t[0],i):e,i},sa=()=>{const e=oa(),t=ue("g"),a=ue("g","multi"),n=n=>{n.selection&&(a.transition(n),t.transition(n));const i=e.mapping(),r=e.series(),l=e.xScale(),d=e.yScale();n.each((n,s,c)=>{const u=a(o.select(c[s]),r);u.each((e,a,s)=>{e.xScale(l).yScale(d);const c=i(n,a,r),u=t(o.select(s[a]),[c]);u.call(e)});const h=u.selection?u.selection():u;h.order(),e.decorate()(u,n,s)})};return X(n,e),q(n,a,"key"),n},ca=()=>{let e=null;const t=oa(),a=a=>{const n=t.mapping(),i=t.series(),r=t.xScale(),l=t.yScale();i.forEach((d,o)=>{const s=n(a,o,i);d.context(e).xScale(r).yScale(l);let u;d.decorate?(u=d.decorate(),d.decorate((e,n,r)=>{t.decorate()(e,a,o),u(e,n,r)})):t.decorate()(e,a,o),d(s),u&&d.decorate(u)})};return a.context=(...t)=>t.length?(e=t[0],a):e,X(a,t),a},ua=()=>{let e=()=>50,n="center";const r=a.scaleBand(),l=ke({decorate:()=>{},xScale:a.scaleLinear(),yScale:a.scaleLinear()});return l.offsetScaleForDatum=(a,l,d)=>{const i=e(l,d),o=Ve(n,i),s=i/2;return r.domain(t.range(0,a.length)).range([-s+o,s+o])},l.bandwidth=(...t)=>t.length?(e=Ae(t[0]),l):e,l.align=(...e)=>e.length?(n=e[0],l):n,X(l,r,$({paddingInner:"paddingOuter"})),l},ha=()=>{let e="vertical",t=Te();const a=ca(),n=n=>{"vertical"===e?a.series(n[0].map(()=>t)).mapping((e,t)=>e.map(e=>e[t])):a.series(n.map(()=>t)).mapping((e,t)=>e[t]),a(n)};return n.series=(...e)=>e.length?(t=e[0],n):t,n.orient=(...t)=>t.length?(e=t[0],n):e,X(n,a,Z("series","mapping")),n};const ga=e=>e.sort(t.ascending).filter((e,t,a)=>-1===a.indexOf(e,t+1));var fa=()=>{let e=e=>e.x,n=e=>e.y,r=e=>e.color,l=()=>5,o=()=>5,s=a.interpolateViridis;const c=ke({decorate:()=>{},defined:(t,a)=>L(e,n,r)(t,a),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return c.pathGenerator=re().x(0).y(0),c.colorScale=e=>{const n=e.map(r);return a.scaleLinear().domain([t.min(n),t.max(n)])},c.values=(t,a)=>({x:c.xScale()(e(t,a)),y:c.yScale()(n(t,a)),colorValue:r(t,a),width:o(t,a),height:l(t,a)}),c.xValues=()=>[e],c.yValues=()=>[n],c.xValue=(...t)=>t.length?(e=Ae(t[0]),c):e,c.yValue=(...e)=>e.length?(n=Ae(e[0]),c):n,c.colorValue=(...e)=>e.length?(r=Ae(e[0]),c):r,c.colorInterpolate=(...e)=>e.length?(s=e[0],c):s,c.xBandwidth=(...e)=>e.length?(o=Ae(e[0]),c):o,c.yBandwidth=(...e)=>e.length?(l=Ae(e[0]),c):l,X(c,c.pathGenerator,$({horizontalAlign:"xAlign",verticalAlign:"yAlign"})),c},pa=e=>"function"==typeof e?e:()=>e,ma=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n=e=>e,i=n,r=()=>{},l="horizontal";const d=ue("g","annotation-line"),s=a=>{if(a.selection&&d.transition(a),"horizontal"!==l&&"vertical"!==l)throw new Error("Invalid orientation");const s="horizontal"===l,c=s?(e,t)=>`translate(${e}, ${t})`:(e,t)=>`translate(${t}, ${e})`,u=s?"x2":"y2",h=s?e:t,g=s?t:e,f=s?"left-handle":"bottom-handle",p=s?"right-handle":"top-handle",m=s?"9":"0",b=s?"0":"9",y=s?"0.32em":"0.71em",x=s?"start":"middle",v=h.range(),S=(...e)=>c(v[0],g(n(...e))),w=v[1]-v[0];a.each((e,t,a)=>{const n=d(o.select(a[t]),e),s=n.enter().attr("transform",S).style("stroke","#bbb");s.append("line").attr(u,w),s.append("g").classed(f,!0).style("stroke","none"),s.append("g").classed(p,!0).style("stroke","none").attr("transform",c(w,0)).append("text").attr("text-anchor",x).attr("x",m).attr("y",b).attr("dy",y),n.attr("class",`annotation-line ${l}`),n.attr("transform",S),n.select("line").attr(u,w),n.select("g."+p).attr("transform",c(w,0)),n.select("text").text(i),r(n,e,t)})};return s.xScale=(...t)=>t.length?(e=t[0],s):e,s.yScale=(...e)=>e.length?(t=e[0],s):t,s.value=(...e)=>e.length?(n=pa(e[0]),s):n,s.label=(...e)=>e.length?(i=pa(e[0]),s):i,s.decorate=(...e)=>e.length?(r=e[0],s):r,s.orient=(...e)=>e.length?(l=e[0],s):l,s},ba=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n=e=>e,r=n,l=()=>{},d="horizontal";const o=s.line(),c=a=>{if("horizontal"!==d&&"vertical"!==d)throw new Error("Invalid orientation");const s="horizontal"===d,c=o.context(),u=s?e:t,h=s?t:e,g=u.domain(),f=s?9:0,p=s?0:9,m=s?"left":"center",b=s?"middle":"hanging";a.forEach((e,t)=>{c.save(),c.beginPath(),c.strokeStyle="#bbb",c.fillStyle="#000",c.textAlign=m,c.textBaseline=b,l(c,e,t),o.context(c)(g.map(t=>{const a=[u(t),h(n(e))];return s?a:a.reverse()}));const a=s?u(g[1]):h(n(e)),i=s?h(n(e)):u(g[1]);c.fillText(r(e),a+f,i+p),c.fill(),c.stroke(),c.closePath(),c.restore()})};return c.xScale=(...t)=>t.length?(e=t[0],c):e,c.yScale=(...e)=>e.length?(t=e[0],c):t,c.value=(...e)=>e.length?(n=pa(e[0]),c):n,c.label=(...e)=>e.length?(r=pa(e[0]),c):r,c.decorate=(...e)=>e.length?(l=e[0],c):l,c.orient=(...e)=>e.length?(d=e[0],c):d,q(c,o,"context"),c},ya=()=>{let e=a.scaleIdentity(),t=[10],n=null;const i=()=>null==n?e.ticks?e.ticks(...t):e.domain():n;return i.scale=(...t)=>t.length?(e=t[0],i):e,i.ticks=(...e)=>(t=e,i),i.tickArguments=(...e)=>e.length?(t=e[0],i):t,i.tickValues=(...e)=>e.length?(n=e[0],i):n,i};const xa=e=>e;const va=e=>e,Sa=(e,t,a={})=>{let n=[10],i=null,r=()=>{},l=null,d=6,c=6,u=3;const h=s.line(),f=ue("g","tick").key(va),p=ue("path","domain"),m=()=>({offset:[0,c+u]}),b=()=>({path:[[0,0],[0,c]]}),y=a.labelOffset||m,x=a.tickPath||b,v=(e,t)=>{let a=0;return e.bandwidth&&(a=e.bandwidth()/2,e.round()&&(a=O(a))),n=>t(e(n)+a,0)},S=(e,t)=>A()?`translate(${t}, ${e})`:`translate(${e}, ${t})`,w=e=>A()?e.map(e=>[e[1],e[0]]):e,A=()=>"left"===e||"right"===e,V=(e,a,n)=>t[e]?t[e].apply(t,a):n,k=a=>{a.selection&&(f.transition(a),p.transition(a)),a.each((a,s,c)=>{const u=c[s],m=o.select(u);u.__scale__||m.attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","right"===e?"start":"left"===e?"end":"middle");const b=u.__scale__||t;u.__scale__=t.copy();const k=null==i?V("ticks",n,t.domain()):i,E=null==l?V("tickFormat",n,va):l,I="bottom"===e||"right"===e?1:-1,_=([e,t])=>[e,I*t],T=t.range(),N=w([[T[0],I*d],[T[0],0],[T[1],0],[T[1],I*d]]),B=p(m,[a]);B.attr("d",h(N)).attr("stroke","#000");const R=f(m,k),g=k.map((e,t)=>y(e,t,k)),z=k.map((e,t)=>x(e,t,k));R.enter().attr("transform",v(b,S)).append("path").attr("stroke","#000"),R.enter().append("text").attr("transform",(e,t)=>S(..._(g[t].offset))).attr("fill","#000"),R.exit().attr("transform",v(t,S)),R.select("path").attr("visibility",(e,t)=>z[t].hidden&&"hidden").attr("d",(e,t)=>h(w(z[t].path.map(_)))),R.select("text").attr("visibility",(e,t)=>g[t].hidden&&"hidden").attr("transform",(e,t)=>S(..._(g[t].offset))).attr("dy",()=>{let t="0em";return A()?t="0.32em":"bottom"===e&&(t="0.71em"),t}).text(E),R.attr("transform",v(t,S)),r(R,a,s)})};return k.tickFormat=(...e)=>e.length?(l=e[0],k):l,k.tickSize=(...e)=>e.length?(c=d=+e[0],k):c,k.tickSizeInner=(...e)=>e.length?(c=+e[0],k):c,k.tickSizeOuter=(...e)=>e.length?(d=+e[0],k):d,k.tickPadding=(...e)=>e.length?(u=e[0],k):u,k.decorate=(...e)=>e.length?(r=e[0],k):r,k.scale=(...e)=>e.length?(t=e[0],k):t,k.ticks=(...e)=>(n=[...e],k),k.tickArguments=(...e)=>e.length?(n=null==e[0]?[]:[...e[0]],k):n.slice(),k.tickValues=(...e)=>e.length?(i=null==e[0]?[]:[...e[0]],k):i.slice(),k.orient=()=>e,k},wa=(e,t)=>{let a=!1;const n=(e,n,r)=>{let l=0,d=i.tickSizeInner()+i.tickPadding(),o=!1;if(a){const a=t(e),s=n<r.length-1?t(r[n+1]):t.range()[1];l=(s-a)/2,d=i.tickPadding(),o=n===r.length-1&&a===s}return{offset:[l,d],hidden:o}},i=Sa(e,t,{labelOffset:n}),r=e=>i(e);return r.tickCenterLabel=(...e)=>e.length?(a=e[0],r):a,X(r,i),r},Aa=e=>wa("top",e),Va=e=>wa("bottom",e),ka=e=>wa("left",e),Ea=e=>wa("right",e),Ia=(e,t)=>{let a=null;const n=(e,a,n)=>{if(t.step)return t.step();const i=t(e);return a<n.length-1?t(n[a+1])/i:2*(t.range()[1]-i)},i=(e,t,i)=>{let l=0;return l=a?a(e,t):n(e,t,i)/2,{path:[[l,0],[l,r.tickSizeInner()]],hidden:t===i.length-1}},r=Sa(e,t,{labelOffset:()=>({offset:[0,r.tickPadding()]}),tickPath:i}),l=e=>{r(e)};return l.tickOffset=(...e)=>e.length?(a=e[0],l):a,X(l,r),l};var _a=e=>{return t=>{const a=e.ticks?e.ticks():e.domain(),n=t.append("text"),i=a.map(e=>n.text(e).node().getBBox()),r=Y(...i.map(e=>e.height)),l=Y(...i.map(e=>e.width));return n.remove(),{maxHeight:r,maxWidth:l,labelCount:a.length}}};const Ta="__d3fc-elements__",Na=e=>e[Ta]||{},Ba=(e,t)=>void(e[Ta]=t),Ra=e=>delete e[Ta],za=e=>"D3FC-GROUP"===e.tagName?[e,...e.querySelectorAll("d3fc-canvas, d3fc-group, d3fc-svg")]:[e],Pa=e=>{const{width:t,height:a}=Na(e),n=e.useDevicePixelRatio&&null!=window.devicePixelRatio?window.devicePixelRatio:1,i=e.clientWidth*n,r=e.clientHeight*n;Ba(e,{pixelRatio:n,width:i,height:r,resized:i!==t||r!==a})};if("function"!=typeof CustomEvent)throw new Error("d3fc-element depends on CustomEvent. Make sure that you load a polyfill in older browsers. See README.");const Da=e=>{const t=Na(e),a=new CustomEvent("measure",{detail:t});e.dispatchEvent(a)},La=e=>{const t=Na(e),a=new CustomEvent("draw",{detail:t});e.dispatchEvent(a)};var Ca=e=>{const t=e.map(za).reduce((e,t)=>e.concat(t));t.forEach(Pa),t.forEach(Da),t.forEach(La)};const Ha=e=>Na(e.ownerDocument).queue||[],Oa=(e,t)=>{let{requestId:a}=Na(e.ownerDocument);null==a&&(a=requestAnimationFrame(()=>{const t=Ha(e);Ca(t),Ga(e)})),Ba(e.ownerDocument,{queue:t,requestId:a})},Ga=e=>Ra(e.ownerDocument),Ua=(e,t)=>{let a=e;do if(a.parentNode===t)return!0;while(a=a.parentNode);return!1};var Fa=e=>{const t=Ha(e),a=-1<t.indexOf(e);if(!a){const a=t.some(t=>Ua(e,t));if(!a){const a=t.filter(t=>!Ua(t,e));a.push(e),Oa(e,a)}}};if("function"!=typeof HTMLElement)throw new Error("d3fc-element depends on Custom Elements (v1). Make sure that you load a polyfill in older browsers. See README.");const Ma=e=>{null!=e.__measureListener__||(e.__measureListener__=t=>e.setMeasurements(t.detail),e.addEventListener("measure",e.__measureListener__))},Ya=e=>{null==e.__measureListener__||(e.removeEventListener("measure",e.__measureListener__),e.__measureListener__=null)};var Wa=(e,t)=>class extends HTMLElement{static get observedAttributes(){return["use-device-pixel-ratio"]}attributeChangedCallback(e){"use-device-pixel-ratio"===e?this.requestRedraw():void 0}connectedCallback(){0===this.childNodes.length&&this.appendChild(e()),Ma(this)}disconnectedCallback(){Ya(this)}setMeasurements({width:e,height:a}){const{childNodes:[n,...i]}=this;if(0<i.length)throw new Error("A d3fc-svg/canvas element must only contain a single svg/canvas element.");t(this,n,{width:e,height:a})}get useDevicePixelRatio(){return this.hasAttribute("use-device-pixel-ratio")&&"false"!==this.getAttribute("use-device-pixel-ratio")}set useDevicePixelRatio(e){e&&!this.useDevicePixelRatio?this.setAttribute("use-device-pixel-ratio",""):!e&&this.useDevicePixelRatio&&this.removeAttribute("use-device-pixel-ratio"),this.requestRedraw()}requestRedraw(){Fa(this)}};class Qa extends Wa(()=>document.createElement("canvas"),(e,t,{width:a,height:n})=>{if(t.setAttribute("width",a),t.setAttribute("height",n),e.setWebglViewport){const e=t.getContext("webgl");e.viewport(0,0,a,n)}}){get setWebglViewport(){return this.hasAttribute("set-webgl-viewport")&&"false"!==this.getAttribute("set-webgl-viewport")}set setWebglViewport(e){e&&!this.setWebglViewport?this.setAttribute("set-webgl-viewport",""):!e&&this.setWebglViewport&&this.removeAttribute("set-webgl-viewport"),this.requestRedraw()}}const qa=e=>{e.autoResize?ja(e):Xa(e)},ja=e=>{null!=e.__autoResizeListener__||(e.__autoResizeListener__=()=>Fa(e),addEventListener("resize",e.__autoResizeListener__))},Xa=e=>{null==e.__autoResizeListener__||(removeEventListener("resize",e.__autoResizeListener__),e.__autoResizeListener__=null)};class Ka extends HTMLElement{connectedCallback(){qa(this)}disconnectedCallback(){Xa(this)}requestRedraw(){Fa(this)}get autoResize(){return this.hasAttribute("auto-resize")&&"false"!==this.getAttribute("auto-resize")}set autoResize(e){e&&!this.autoResize?this.setAttribute("auto-resize",""):!e&&this.autoResize&&this.removeAttribute("auto-resize"),qa(this)}static get observedAttributes(){return["auto-resize"]}attributeChangedCallback(e){"auto-resize"===e?qa(this):void 0}}var Za=Wa(()=>document.createElementNS("http://www.w3.org/2000/svg","svg"),(e,t,{width:a,height:n})=>{t.setAttribute("viewBox",`0 0 ${a} ${n}`)});const Ja=document.createElement("style");if(Ja.setAttribute("type","text/css"),document.querySelector("head").appendChild(Ja),Ja.styleSheet?Ja.styleSheet.cssText+="d3fc-canvas,d3fc-svg{position:relative;display:block}d3fc-canvas>canvas,d3fc-svg>svg{position:absolute;height:100%;width:100%}d3fc-svg>svg{overflow:visible}":Ja.textContent+="d3fc-canvas,d3fc-svg{position:relative;display:block}d3fc-canvas>canvas,d3fc-svg>svg{position:absolute;height:100%;width:100%}d3fc-svg>svg{overflow:visible}","object"!=typeof customElements||"function"!=typeof customElements.define)throw new Error("d3fc-element depends on Custom Elements (v1). Make sure that you load a polyfill in older browsers. See README.");customElements.define("d3fc-canvas",Qa),customElements.define("d3fc-group",Ka),customElements.define("d3fc-svg",Za);var $a=(...e)=>{const t={},a=e=>{for(const a of Object.keys(t))e[a].apply(null,t[a]);return e};for(const n of e)a[n]=(...e)=>e.length?(t[n]=e,a):t[n];return a};const en=document.createElement("style");en.setAttribute("type","text/css"),document.querySelector("head").appendChild(en),en.styleSheet?en.styleSheet.cssText+="d3fc-group.cartesian-chart{width:100%;height:100%;overflow:hidden;display:grid;display:-ms-grid;grid-template-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);grid-template-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);}\nd3fc-group.cartesian-chart>.top-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:1;-ms-grid-row:1;}\nd3fc-group.cartesian-chart>.top-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:2;-ms-grid-row:2;}\nd3fc-group.cartesian-chart>.left-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:1;-ms-grid-column:1;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.left-axis{width:3em;grid-column:2;-ms-grid-column:2;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.plot-area{overflow:hidden;grid-column:3;-ms-grid-column:3;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-axis{width:3em;grid-column:4;-ms-grid-column:4;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:5;-ms-grid-column:5;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.bottom-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:4;-ms-grid-row:4;}\nd3fc-group.cartesian-chart>.bottom-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:5;-ms-grid-row:5;}\nd3fc-group.cartesian-chart>.y-label{display:flex;transform:rotate(-90deg);width:1em;white-space:nowrap;justify-content:center;}":en.textContent+="d3fc-group.cartesian-chart{width:100%;height:100%;overflow:hidden;display:grid;display:-ms-grid;grid-template-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);grid-template-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);}\nd3fc-group.cartesian-chart>.top-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:1;-ms-grid-row:1;}\nd3fc-group.cartesian-chart>.top-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:2;-ms-grid-row:2;}\nd3fc-group.cartesian-chart>.left-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:1;-ms-grid-column:1;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.left-axis{width:3em;grid-column:2;-ms-grid-column:2;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.plot-area{overflow:hidden;grid-column:3;-ms-grid-column:3;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-axis{width:3em;grid-column:4;-ms-grid-column:4;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:5;-ms-grid-column:5;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.bottom-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:4;-ms-grid-row:4;}\nd3fc-group.cartesian-chart>.bottom-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:5;-ms-grid-row:5;}\nd3fc-group.cartesian-chart>.y-label{display:flex;transform:rotate(-90deg);width:1em;white-space:nowrap;justify-content:center;}";const tn=e=>"function"==typeof e?e:()=>e;var an=(...e)=>{const{xScale:t,yScale:a,xAxis:n,yAxis:r}=nn(...e);let l=tn(""),d=tn(""),s=tn(""),c=tn(null),u=tn(null),h=tn("right"),g=tn("bottom"),f=null,p=null,m=null,b=!1,y=$a("tickFormat","ticks","tickArguments","tickSize","tickSizeInner","tickSizeOuter","tickValues","tickPadding","tickCenterLabel"),x=()=>{},v=$a("tickFormat","ticks","tickArguments","tickSize","tickSizeInner","tickSizeOuter","tickValues","tickPadding","tickCenterLabel"),S=()=>{},w=()=>{};const A=ue("d3fc-group","cartesian-chart"),V=ue("d3fc-canvas","webgl-plot-area"),k=ue("d3fc-canvas","canvas-plot-area"),E=ue("d3fc-svg","svg-plot-area"),I=ue("d3fc-svg","x-axis").key(e=>e),_=ue("d3fc-svg","y-axis").key(e=>e),T=ue("div","chart-label"),N=ue("div","x-label").key(e=>e),B=ue("div","y-label").key(e=>e),R=e=>t=>e.selection?t.transition(e):t,z=e=>{const z=R(e);e.each((e,i,R)=>{const P=A(o.select(R[i]),[e]);P.enter().attr("auto-resize",""),T(P,[g(e)]).attr("class",e=>"top"===e?"chart-label bottom-label":"chart-label top-label").style("margin-bottom",e=>"top"===e?0:"1em").style("margin-top",e=>"top"===e?"1em":0).text(l(e)),N(P,[g(e)]).attr("class",e=>`x-label ${e}-label`).text(d(e)),B(P,[h(e)]).attr("class",e=>`y-label ${e}-label`).text(s(e)),V(P,f?[e]:[]).attr("set-webgl-viewport","").classed("plot-area",!0).on("draw",(e,n,i)=>{const r=o.select(i[n]).select("canvas").node();f.context(b?null:r.getContext("webgl")).xScale(t).yScale(a),f(e)}),P.select(".webgl-plot-area>canvas").on("webglcontextlost",()=>{console.warn("WebGLRenderingContext lost"),o.event.preventDefault(),b=!0,P.node().requestRedraw()}).on("webglcontextrestored",()=>{console.info("WebGLRenderingContext restored"),b=!1,P.node().requestRedraw()}),k(P,p?[e]:[]).classed("plot-area",!0).on("draw",(e,n,i)=>{const r=o.select(i[n]).select("canvas").node();p.context(r.getContext("2d")).xScale(t).yScale(a),p(e)}),E(P,m?[e]:[]).classed("plot-area",!0).on("draw",(e,n,i)=>{m.xScale(t).yScale(a),z(o.select(i[n])).select("svg").call(m)}),I(P,[g(e)]).attr("class",e=>`x-axis ${e}-axis`).style("height",c(e)).on("measure",(e,a,n)=>{const{width:i,height:r}=o.event.detail;"top"===e&&o.select(n[a]).select("svg").attr("viewBox",`0 ${-r} ${i} ${r}`),t.range([0,i])}).on("draw",(e,a,i)=>{const r="top"===e?n.top(t):n.bottom(t);r.decorate(x),z(o.select(i[a])).select("svg").call(y(r))}),_(P,[h(e)]).attr("class",e=>`y-axis ${e}-axis`).style("width",u(e)).on("measure",(e,t,n)=>{const{width:i,height:r}=o.event.detail;"left"===e&&o.select(n[t]).select("svg").attr("viewBox",`${-i} 0 ${i} ${r}`),a.range([r,0])}).on("draw",(e,t,n)=>{const i="left"===e?r.left(a):r.right(a);i.decorate(S),z(o.select(n[t])).select("svg").call(v(i))}),P.each((e,t,a)=>a[t].requestRedraw()),w(P,e,i)})},P=Z(/range\w*/,/tickFormat/);return X(z,t,P,te("x")),X(z,a,P,te("y")),X(z,y,te("x")),X(z,v,te("y")),z.xOrient=(...e)=>e.length?(g=tn(e[0]),z):g,z.yOrient=(...e)=>e.length?(h=tn(e[0]),z):h,z.xDecorate=(...e)=>e.length?(x=e[0],z):x,z.yDecorate=(...e)=>e.length?(S=e[0],z):S,z.chartLabel=(...e)=>e.length?(l=tn(e[0]),z):l,z.xLabel=(...e)=>e.length?(d=tn(e[0]),z):d,z.yLabel=(...e)=>e.length?(s=tn(e[0]),z):s,z.xAxisHeight=(...e)=>e.length?(c=tn(e[0]),z):c,z.yAxisWidth=(...e)=>e.length?(u=tn(e[0]),z):u,z.webglPlotArea=(...e)=>e.length?(f=e[0],z):f,z.canvasPlotArea=(...e)=>e.length?(p=e[0],z):p,z.svgPlotArea=(...e)=>e.length?(m=e[0],z):m,z.decorate=(...e)=>e.length?(w=e[0],z):w,z};const nn=(...e)=>{const t={xScale:a.scaleIdentity(),yScale:a.scaleIdentity(),xAxis:{bottom:Va,top:Aa},yAxis:{right:Ea,left:ka}};return 1!==e.length||e[0].domain||e[0].range?Object.assign(t,{xScale:e[0]||t.xScale,yScale:e[1]||t.yScale}):Object.assign(t,e[0])},rn=e=>"function"==typeof e?e:()=>e;var ln=(e,t)=>(...a)=>{let n=rn(""),i=t,r=()=>{};const l=an(...a),d=t=>{e(l,i),l.decorate((e,t,a)=>{e.enter().select(".x-label").style("height","1em").style("line-height","1em");const i=l.yOrient()(t);e.enter().append("div").attr("class","y-label-container").style("grid-column","left"===i?1:5).style("-ms-grid-column","left"===i?1:5).style("grid-row",3).style("-ms-grid-row",3).style("width","1em").style("display","flex").style("align-items","center").style("justify-content","center").style("white-space","nowrap").append("div").attr("class","y-label").style("transform","rotate(-90deg)"),e.select(".y-label-container>.y-label").text(n),r(e,t,a)}),t.call(l)};return X(d,l,J(/^x/,/^y/,"chartLabel")),d.yLabel=(...e)=>e.length?(n=rn(e[0]),d):n,d.plotArea=(...e)=>e.length?(i=e[0],d):i,d.decorate=(...e)=>e.length?(r=e[0],d):r,d},dn=ln((e,t)=>e.svgPlotArea(t),_e),on=ln((e,t)=>e.canvasPlotArea(t),Te);const sn=e=>"x"===e?u.brushX():"y"===e?u.brushY():"xy"===e?u.brush():void 0,cn=e=>[e[1],e[0]],un=e=>{const t=sn(e),n=c.dispatch("brush","start","end");let i=a.scaleIdentity(),r=a.scaleIdentity();const l=ue("g","brush"),d=(t,a,n)=>"x"===e?t.map(a):"y"===e?t.map(n):"xy"===e?[[a(t[0][0]),n(t[0][1])],[a(t[1][0]),n(t[1][1])]]:void 0,s=e=>d(e,a.scaleLinear().domain(i.range()).invert,a.scaleLinear().domain(cn(r.range())).invert),u=e=>d(e,a.scaleLinear().domain(i.range()),a.scaleLinear().domain(cn(r.range()))),h=t=>{const n=a.scaleLinear().domain(i.domain());return"x"===e?t.map(n.invert):"xy"===e?[n.invert(t[0][0]),n.invert(t[1][0])]:void 0},g=t=>{const n=a.scaleLinear().domain(cn(r.domain()));return"y"===e?[t[1],t[0]].map(n.invert):"xy"===e?[n.invert(t[1][1]),n.invert(t[0][1])]:void 0},f=e=>{if(!(e.sourceEvent&&"draw"===e.sourceEvent.type))if(e.selection){const t=u(e.selection);n.call(e.type,{},{selection:t,xDomain:h(t),yDomain:g(t)})}else n.call(e.type,{},{})},p=e=>{e.each((e,a,n)=>{t.extent([[i.range()[0],r.range()[1]],[i.range()[1],r.range()[0]]]),t.on("end",()=>f(o.event)).on("brush",()=>f(o.event)).on("start",()=>f(o.event));const d=l(o.select(n[a]),[e]);d.call(t).call(t.move,e?s(e):null)})};return p.xScale=(...e)=>e.length?(i=e[0],p):i,p.yScale=(...e)=>e.length?(r=e[0],p):r,q(p,n,"on"),q(p,t,"filter","handleSize"),p};e.annotationCanvasBand=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n="horizontal",r=e=>e.from,l=e=>e.to,o=()=>{};const s=re().horizontalAlign("right").verticalAlign("top");var c=a=>{if("horizontal"!==n&&"vertical"!==n)throw new Error("Invalid orientation");const c=s.context(),u="horizontal"===n,h=u?e:t,g=u?t:e,f=h.range(),p=f[1]-f[0],m=u?"x":"y",b=u?"y":"x",y=u?"height":"width",x=u?"width":"height";a.forEach((e,t)=>{c.save(),c.beginPath(),c.strokeStyle="transparent",s[b](g(r(e))),s[m](f[0]),s[x](p),s[y](g(l(e))-g(r(e))),o(c,e,t),s.context(c)([e],t),c.fill(),c.stroke(),c.closePath(),c.restore()})};return c.xScale=(...t)=>t.length?(e=t[0],c):e,c.yScale=(...e)=>e.length?(t=e[0],c):t,c.orient=(...e)=>e.length?(n=e[0],c):n,c.decorate=(...e)=>e.length?(o=e[0],c):o,c.fromValue=(...e)=>e.length?(r=pa(e[0]),c):r,c.toValue=(...e)=>e.length?(l=pa(e[0]),c):l,q(c,s,"context"),c},e.annotationCanvasCrosshair=()=>{let e=e=>e.x,t=e=>e.y,n=a.scaleIdentity(),i=a.scaleIdentity();const r=ta(),l=ba(),o=ba().orient("vertical"),s=a.scaleIdentity(),c=a.scaleIdentity(),u=ca().series([l,o,r]).xScale(s).yScale(c).mapping(e=>[e]),h=a=>{a.forEach(a=>{s.range(n.range()),c.range(i.range()),r.crossValue(e).mainValue(t),l.value(t),o.value(e),u(a)})};h.x=(...t)=>t.length?(e=t[0],h):e,h.y=(...e)=>e.length?(t=e[0],h):t,h.xScale=(...e)=>e.length?(n=e[0],h):n,h.yScale=(...e)=>e.length?(i=e[0],h):i;const g=J("label","decorate");return X(h,l,g,te("y")),X(h,o,g,te("x")),q(h,r,"decorate"),q(h,u,"context"),h},e.annotationCanvasGridline=()=>{let e=()=>{},t=()=>{};const a=ya(),n=ya(),r=s.line(),l=()=>{const l=r.context(),o=a.scale(),s=n.scale();a().forEach((t,a)=>{l.save(),l.beginPath(),l.strokeStyle="#bbb",l.fillStyle="transparent",e(l,t,a),r.context(l)(s.domain().map(e=>[o(t),s(e)])),l.fill(),l.stroke(),l.closePath(),l.restore()}),n().forEach((e,a)=>{l.save(),l.beginPath(),l.strokeStyle="#bbb",l.fillStyle="transparent",t(l,e,a),r.context(l)(o.domain().map(t=>[o(t),s(e)])),l.fill(),l.stroke(),l.closePath(),l.restore()})};return l.yDecorate=(...e)=>e.length?(t=e[0],l):t,l.xDecorate=(...t)=>t.length?(e=t[0],l):e,X(l,a,te("x")),X(l,n,te("y")),q(l,r,"context"),l},e.annotationCanvasLine=ba,e.annotationSvgBand=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n="horizontal",i=e=>e.from,r=e=>e.to,l=()=>{};const d=ue("g","annotation-band"),s=re().horizontalAlign("center").verticalAlign("center").x(0).y(0);var c=a=>{if(a.selection&&d.transition(a),"horizontal"!==n&&"vertical"!==n)throw new Error("Invalid orientation");const c="horizontal"===n,u=c?(e,t)=>`translate(${e}, ${t})`:(e,t)=>`translate(${t}, ${e})`,h=c?e:t,g=c?t:e,f=h.range(),p=f[1]-f[0],m=c?"height":"width",b=c?"width":"height",y=(...e)=>u((f[1]+f[0])/2,(g(r(...e))+g(i(...e)))/2);s[b](p),s[m]((...e)=>g(r(...e))-g(i(...e))),a.each((e,t,a)=>{var i=d(o.select(a[t]),e);i.enter().attr("transform",y).append("path").classed("band",!0),i.attr("class",`annotation-band ${n}`).attr("transform",y).select("path").attr("d",(e,t)=>s([e],t)),l(i,e,t)})};return c.xScale=(...t)=>t.length?(e=t[0],c):e,c.yScale=(...e)=>e.length?(t=e[0],c):t,c.orient=(...e)=>e.length?(n=e[0],c):n,c.decorate=(...e)=>e.length?(l=e[0],c):l,c.fromValue=(...e)=>e.length?(i=pa(e[0]),c):i,c.toValue=(...e)=>e.length?(r=pa(e[0]),c):r,c},e.annotationSvgCrosshair=function(){let e=e=>e.x,t=e=>e.y,n=a.scaleIdentity(),i=a.scaleIdentity(),r=()=>{};const l=ue("g","annotation-crosshair"),d=ea(),s=ma(),c=ma().orient("vertical"),u=a.scaleIdentity(),h=a.scaleIdentity(),f=sa().series([s,c,d]).xScale(u).yScale(h).mapping(e=>[e]),p=a=>{a.selection&&l.transition(a),a.each((a,p,m)=>{const b=l(o.select(m[p]),a);b.enter().style("pointer-events","none"),u.range(n.range()),h.range(i.range()),d.crossValue(e).mainValue(t),s.value(t),c.value(e),b.call(f),r(b,a,p)})};p.x=(...t)=>t.length?(e=t[0],p):e,p.y=(...e)=>e.length?(t=e[0],p):t,p.xScale=(...e)=>e.length?(n=e[0],p):n,p.yScale=(...e)=>e.length?(i=e[0],p):i,p.decorate=(...e)=>e.length?(r=e[0],p):r;const m=J("label");return X(p,s,m,te("y")),X(p,c,m,te("x")),p},e.annotationSvgGridline=()=>{let e=()=>{},t=()=>{};const a=ya(),n=ya(),i=ue("line","gridline-y").key(xa),r=ue("line","gridline-x").key(xa),l=l=>{l.selection&&(i.transition(l),r.transition(l)),l.each((l,d,s)=>{const c=s[d],u=o.select(s[d]),h=a.scale(),g=n.scale(),f=c.__x_scale__||h;c.__x_scale__=h.copy();const p=a(),m=i(u,p);m.enter().attr("x1",f).attr("x2",f).attr("y1",g.range()[0]).attr("y2",g.range()[1]),m.attr("x1",h).attr("x2",h).attr("y1",g.range()[0]).attr("y2",g.range()[1]).attr("stroke","#bbb"),m.exit().attr("x1",h).attr("x2",h),e(m,p,d);const b=c.__y_scale__||g;c.__y_scale__=g.copy();const y=n(),x=r(u,y);x.enter().attr("y1",b).attr("y2",b).attr("x1",h.range()[0]).attr("x2",h.range()[1]),x.attr("y1",g).attr("y2",g).attr("x1",h.range()[0]).attr("x2",h.range()[1]).attr("stroke","#bbb"),x.exit().attr("y1",g).attr("y2",g),t(x,y,d)})};return l.yDecorate=(...e)=>e.length?(t=e[0],l):t,l.xDecorate=(...t)=>t.length?(e=t[0],l):e,X(l,i,$({key:"xKey"})),X(l,r,$({key:"yKey"})),X(l,a,te("x")),X(l,n,te("y")),l},e.annotationSvgLine=ma,e.autoBandwidth=e=>{let a=.75;const n=e=>{if(1>=e.length)return 10;e=ga(e);const n=t.pairs(e).map(e=>W(e[0]-e[1])),i=t.min(n);return a*i},i=(t,a,i)=>{if(t.bandwidth)return t.bandwidth();else{const r=Array.isArray(a)?[].concat(...a):a,l=r.filter(e.defined()).map(i()).map(t),d=n(l);return d}},r=t=>{const a=t=>{if(e.xBandwidth&&e.yBandwidth)e.xBandwidth(i(e.xScale(),t,e.xValue)),e.yBandwidth(i(e.yScale(),t,e.yValue));else{const a=e.orient&&"horizontal"===e.orient()?e.yScale():e.xScale();e.bandwidth(i(a,t,e.crossValue))}};t instanceof o.selection?t.each((t,n,i)=>{a(t),e(o.select(i[n]))}):(a(t),e(t))};return X(r,e),r.widthFraction=(...e)=>e.length?(a=e[0],r):a,r},e.axisBottom=Va,e.axisLabelOffset=e=>{let t="auto",a=()=>{};const n=()=>"left"===e.orient()||"right"===e.orient(),r=()=>"top"===e.orient()||"left"===e.orient()?-1:1,l=a=>{const{maxHeight:l,maxWidth:d,labelCount:o}=_a(e.scale())(a),s=e.scale().range()[1],c="auto"===t?G((n()?l:d)*o/s)+1:t,u=a.select("text"),h=u.attr("transform"),g=e=>n()?`translate(${e%c*d*r()}, 0)`:`translate(0, ${e%c*l*r()})`;u.attr("transform",(e,t)=>`${h} ${g(t)}`)},d=t=>e(t);return e.decorate(e=>{l(e),a(e)}),d.decorate=(...e)=>e.length?(a=e[0],d):a,d.labelOffsetDepth=(...e)=>e.length?(t=e[0],d):t,X(d,e,Z("decorate")),d},e.axisLabelRotate=e=>{let t="auto",a=()=>{};const n=()=>"left"===e.orient()||"right"===e.orient(),i=()=>"top"===e.orient()||"left"===e.orient()?-1:1,r=()=>{switch(e.orient()){case"top":case"right":return"start";default:return"end";}},l=a=>{const{maxHeight:l,maxWidth:d,labelCount:o}=_a(e.scale())(a),s=o*d;let c;if("auto"===t){const t=e.scale().range()[1];c=t<s?90*U(1,(s/t-.8)/2):0}else c=t;return{rotate:n()?G(i()*(90-c)):G(-c),maxHeight:l,maxWidth:d,anchor:c?r():"middle"}},d=e=>{const{rotate:t,maxHeight:a,anchor:r}=l(e),d=e.select("text"),o=d.attr("transform"),s=i()*G(a/2),c=n()?`translate(${s}, 0)`:`translate(0, ${s})`;d.style("text-anchor",r).attr("transform",`${o} ${c} rotate(${t} 0 0)`)},o=t=>{e(t)};return e.decorate(e=>{d(e),a(e)}),o.decorate=(...e)=>e.length?(a=e[0],o):a,o.labelRotate=(...e)=>e.length?(t=e[0],o):t,X(o,e,Z("decorate")),o},e.axisLeft=ka,e.axisOrdinalBottom=e=>Ia("bottom",e),e.axisOrdinalLeft=e=>Ia("left",e),e.axisOrdinalRight=e=>Ia("right",e),e.axisOrdinalTop=e=>Ia("top",e),e.axisRight=Ea,e.axisTop=Aa,e.brush=()=>un("xy"),e.brushX=()=>un("x"),e.brushY=()=>un("y"),e.bucket=R,e.chartCanvasCartesian=on,e.chartCartesian=an,e.chartSvgCartesian=dn,e.dataJoin=ue,e.discontinuityIdentity=A,e.discontinuityRange=(...e)=>{const t=(e,t)=>e>t[0]&&e<t[1],a=(e,t)=>e[0]>=t[0]&&e[1]<=t[1];var n={};n.distance=(t,i)=>{t=n.clampUp(t),i=n.clampDown(i);const r=e.filter(e=>a(e,[t,i])),l=r.map(e=>e[1]-e[0]);return i-t-l.reduce((e,t)=>e+t,0)};const i=(e,t)=>e instanceof Date?new Date(e.getTime()+t):e+t;return n.offset=(t,a)=>{if(0<a){let l=n.clampUp(t),d=a;for(;0<d;){const t=e.filter(e=>e[0]>l).sort((e,t)=>e[0]-t[0]);if(t.length){const e=t[0],a=e[0]-l;a>d?(l=i(l,d),d=0):(l=e[1],d-=a)}else l=i(l,d),d=0}return l}else{let l=n.clampDown(t),d=a;for(;0>d;){const t=e.filter(e=>e[1]<l).sort((e,t)=>t[0]-e[0]);if(t.length){const e=t[0],a=e[1]-l;a<d?(l=i(l,d),d=0):(l=e[0],d-=a)}else l=i(l,d),d=0}return l}},n.clampUp=a=>e.reduce((e,a)=>t(e,a)?a[1]:e,a),n.clampDown=a=>e.reduce((e,a)=>t(e,a)?a[0]:e,a),n.copy=()=>n,n},e.discontinuitySkipUtcWeekends=()=>ae(e=>e.getUTCDay(),n.utcDay,n.utcSaturday,n.utcMonday),e.discontinuitySkipWeekends=()=>ae(e=>e.getDay(),n.timeDay,n.timeSaturday,n.timeMonday),e.effectivelyZero=ce,e.exclude=Z,e.extentDate=I,e.extentLinear=E,e.extentTime=I,e.feedGdax=B,e.group=()=>{let e="",t="vertical",a=(e,t)=>+e[t];const n=t=>Object.keys(t[0]).filter(t=>t!==e).map(n=>{const i=t.filter(e=>e[n]).map(t=>{const i=[t[e],a(t,n)];return i.data=t,i});return i.key=n,i}),i=t=>t.map(t=>{const n=Object.keys(t).filter(t=>t!==e).map(e=>{const n=[e,a(t,e)];return n.data=t,n});return n.key=t[e],n}),r=e=>"vertical"===t?n(e):i(e);return r.key=(...t)=>t.length?(e=t[0],r):e,r.value=(...e)=>e.length?(a=e[0],r):a,r.orient=(...e)=>e.length?(t=e[0],r):t,r},e.include=J,e.includeMap=$,e.indicatorBollingerBands=b,e.indicatorElderRay=w,e.indicatorEnvelope=S,e.indicatorExponentialMovingAverage=y,e.indicatorForceIndex=function(){let e=e=>e.volume,t=e=>e.close;const a=y().period(13),n=m().period(2).defined(a=>null!=t(a)&&null!=e(a)).accumulator(a=>a&&p((t(a[1])-t(a[0]))*e(a[1]))),i=e=>{const t=n(e);return a(t)};return i.volumeValue=(...t)=>t.length?(e=t[0],i):e,i.closeValue=(...e)=>e.length?(t=e[0],i):t,q(i,a,"period"),i},e.indicatorMacd=x,e.indicatorMovingAverage=v,e.indicatorRelativeStrengthIndex=function(){const e=m().period(14),a=(e,t)=>t+(e[e.length-1]-t)/e.length,n=([e,t])=>e<t?0:e-t,i=([e,t])=>e>t?0:t-e,r=(e,n)=>void 0===n?t.mean(e):a(e,n),l=()=>{let e,a,l;return d=>{if(!d)return void(void 0!==e&&(e=NaN));if(void 0===e)return void(e=d[0]);const o=t.pairs([e,...d]);a=r(o.map(n),a),l=r(o.map(i),l);const s=isNaN(e)?NaN:l/a;return p(100-100/(1+s))}};var d=t=>{const a=l();return e.accumulator(a),e(t)};return q(d,e,"period","value"),d},e.indicatorStochasticOscillator=function(){let e=e=>e.close,a=e=>e.high,n=e=>e.low;const i=m().period(5).defined(t=>null!=e(t)&&null!=a(t)&&null!=n(t)).accumulator(i=>{const r=i&&t.max(i,a),l=i&&t.min(i,n),d=i&&100*(e(i[i.length-1])-l)/(r-l);return p(d)}),r=v().period(3),l=e=>{const t=i(e),a=r(t);return t.map((e,t)=>({k:e,d:a[t]}))};return l.closeValue=(...t)=>t.length?(e=t[0],l):e,l.highValue=(...e)=>e.length?(a=e[0],l):a,l.lowValue=(...e)=>e.length?(n=e[0],l):n,X(l,i,$({period:"kPeriod"})),X(l,r,$({period:"dPeriod"})),l},e.largestTriangleOneBucket=z,e.largestTriangleThreeBucket=P,e.layoutAnnealing=()=>{let e,t=1e3,a=1;const n=e=>{switch(e.location){case"bottom-right":return 0;case"middle-right":case"bottom-center":return e.width*e.height/8;}return e.width*e.height/4},i=t=>e?t.width*t.height-ge(t,e):0,r=(e,t,a)=>fe(a,t)+i(e)+n(e),l=e=>{let n=t;const i=(e,t)=>M((t-e)/n)>Math.random();let l=xe().locationScore(r).winningScore(i).rectangles(e);for(;0<n;){const t=Se(e),i=ve(me(e[t]));l=l(i,t),n-=a}return l.rectangles()};return l.temperature=(...e)=>e.length?(t=e[0],l):t,l.cooling=(...e)=>e.length?(a=e[0],l):a,l.bounds=(...t)=>t.length?(e=t[0],l):e,l},e.layoutBoundingBox=()=>{let e=[0,0];const t=t=>t.map(t=>{let a=t.x,n=t.y;return a+t.width>e[0]&&(a-=t.width),n+t.height>e[1]&&(n-=t.height),{height:t.height,width:t.width,x:a,y:n}});return t.bounds=(...a)=>a.length?(e=a[0],t):e,t},e.layoutGreedy=()=>{let e;const t=t=>e?t.width*t.height-ge(t,e):0,a=(e,a,n)=>fe(n,a)+t(e),n=e=>{let t=xe().locationScore(a).rectangles(e);return e.forEach((e,a)=>{me(e).forEach(e=>{t=t(e,a)})}),t.rectangles()};return n.bounds=(...t)=>t.length?(e=t[0],n):e,n},e.layoutLabel=e=>{let t=()=>{},n=()=>[0,0],r=e=>[e.x,e.y],l=e||(e=>e),d=()=>{},s=a.scaleIdentity(),c=a.scaleIdentity();const u=ue("g","label"),h=e=>{e.each((e,a,i)=>{const h=u(o.select(i[a]),e).call(d),g=h.nodes(),f=g.map((e,t)=>{let a=o.select(e).datum();const i=r(a,t,g);let l=[s(i[0]),c(i[1])],d=n(a,t,g);return{hidden:!1,x:l[0],y:l[1],width:d[0],height:d[1]}}),p=l(f);h.attr("style",(e,t)=>"display:"+(p[t].hidden?"none":"inherit")).attr("transform",(e,t)=>"translate("+p[t].x+", "+p[t].y+")").attr("layout-width",(e,t)=>p[t].width).attr("layout-height",(e,t)=>p[t].height).attr("anchor-x",(e,t)=>f[t].x-p[t].x).attr("anchor-y",(e,t)=>f[t].y-p[t].y),h.call(d),t(h,e,a)})};return X(h,u,J("key")),X(h,l),h.size=(...e)=>e.length?(n=se(e[0]),h):n,h.position=(...e)=>e.length?(r=se(e[0]),h):r,h.component=(...e)=>e.length?(d=e[0],h):d,h.decorate=(...e)=>e.length?(t=e[0],h):t,h.xScale=(...e)=>e.length?(s=e[0],h):s,h.yScale=(...e)=>e.length?(c=e[0],h):c,h},e.layoutRemoveOverlaps=e=>{e=e||(e=>e);const t=t=>{for(t=e(t);;){const e=t.filter(e=>!e.hidden),a=e.map((t,a)=>[t,fe(e,a)]),n=we(a,(e,t)=>t[1]-e[1]);if(0<n[1])n[0].hidden=!0;else break}return t};return X(t,e),t},e.layoutTextLabel=()=>{let e=2,t=e=>e;const a=ue("text"),n=ue("rect"),i=ue("circle"),r=r=>{r.each((r,l,d)=>{const s=d[l],c=o.select(s);let u=+s.getAttribute("layout-width"),h=+s.getAttribute("layout-height"),g=n(c,[r]);g.attr("width",u).attr("height",h);let f=+s.getAttribute("anchor-x"),p=+s.getAttribute("anchor-y"),m=i(c,[r]);m.attr("r",2).attr("cx",f).attr("cy",p);let b=a(c,[r]);b.enter().attr("dy","0.9em").attr("transform",`translate(${e}, ${e})`),b.text(t)})};return r.padding=(...t)=>t.length?(e=t[0],r):e,r.value=(...e)=>e.length?(t=se(e[0]),r):t,r},e.modeMedian=D,e.pointer=()=>{function e(){const e=o.mouse(this);a.call("point",this,[{x:e[0],y:e[1]}])}function t(){void a.call("point",this,[])}const a=c.dispatch("point"),n=a=>{a.on("mouseenter.pointer",e).on("mousemove.pointer",e).on("mouseleave.pointer",t)};return q(n,a,"on"),n},e.prefix=te,e.randomFinancial=N,e.randomGeometricBrownianMotion=_,e.randomSkipWeekends=function(e){const t=e.date.getDay();return 0!==t&&6!==t},e.rebind=q,e.rebindAll=X,e.scaleDiscontinuous=k,e.seriesCanvasArea=()=>{const e=Ee(),t=s.area(),a=a=>{const n=t.context();t.defined(e.defined());const r=a.map(e.values);t.x((e,t)=>r[t].transposedX).y((e,t)=>r[t].transposedY);const l="vertical"===e.orient()?"y":"x";t[l+"0"]((e,t)=>r[t].y0),t[l+"1"]((e,t)=>r[t].y),n.beginPath(),n.fillStyle=Ie.gray,n.strokeStyle="transparent",e.decorate()(n,a),t(a),n.fill(),n.stroke(),n.closePath()};return X(a,e,Z("bandwidth","align")),q(a,t,"curve","context"),a},e.seriesCanvasBar=()=>{const e=Ee(),t=re().x(0).y(0),a=t=>"vertical"===e.orient()?t.height:t.width,n=t=>"vertical"===e.orient()?t.width:t.height,i=i=>{const r=t.context(),l=i.filter(e.defined()),d=l.map(e.values);"vertical"===e.orient()?(t.verticalAlign("top"),t.horizontalAlign("center")):(t.horizontalAlign("right"),t.verticalAlign("center")),d.forEach((l,d)=>{r.save(),r.beginPath(),r.translate(l.origin[0],l.origin[1]),r.fillStyle=Ie.darkGray,r.strokeStyle="transparent",e.decorate()(r,l.d,d),a(t)(-l.height),n(t)(l.width),t([l]),r.fill(),r.stroke(),r.closePath(),r.restore()})};return X(i,e),q(i,t,"context"),i},e.seriesCanvasBoxPlot=()=>{const e=da(),t=de().value(0),a=a=>{const n=a.filter(e.defined()),r=t.context();t.orient(e.orient()),n.forEach((a,n)=>{r.save();const i=e.values(a,n);r.translate(i.origin[0],i.origin[1]),r.beginPath(),r.fillStyle=Ie.gray,r.strokeStyle=Ie.black,e.decorate()(r,a,n),t.median(i.median).upperQuartile(i.upperQuartile).lowerQuartile(i.lowerQuartile).high(i.high).width(i.width).low(i.low)([a]),r.fill(),r.stroke(),r.closePath(),r.restore()})};return X(a,e),q(a,t,"cap","context"),a},e.seriesCanvasCandlestick=()=>ra(le()),e.seriesCanvasErrorBar=()=>{const e=aa(),t=oe().value(0),a=a=>{const n=a.filter(e.defined()),r=t.context();t.orient(e.orient()),n.forEach((a,n)=>{r.save();const i=e.values(a,n);r.translate(i.origin[0],i.origin[1]),r.beginPath(),r.strokeStyle=Ie.black,r.fillStyle=Ie.gray,e.decorate()(r,a,n),t.high(i.high).width(i.width).low(i.low)([a]),r.fill(),r.stroke(),r.closePath(),r.restore()})};return X(a,e),q(a,t,"context"),a},e.seriesCanvasGrouped=function(e){const t=ua(),a=a=>{a.forEach((n,r)=>{const l="horizontal"!==e.orient(),d=(e,n)=>{const i=t.offsetScaleForDatum(a,e,n),d=l?t.xScale():t.yScale();return d(e)+i(r)+i.bandwidth()/2};l?(e.xScale(d),e.yScale(t.yScale())):(e.yScale(d),e.xScale(t.xScale())),e.bandwidth&&e.bandwidth((e,n)=>t.offsetScaleForDatum(a,e,n).bandwidth()),e.decorate((e,a)=>t.decorate()(e,a,r)),e(n)})};return X(a,e,Z("decorate","xScale","yScale")),X(a,t,Z("offsetScaleForDatum")),a},e.seriesCanvasHeatmap=()=>{const e=fa(),t=t=>{const a=t.filter(e.defined()),n=e.colorInterpolate(),r=e.colorScale(a),l=e.pathGenerator.context();a.forEach((t,a)=>{l.save(),l.beginPath();const i=e.values(t,a);l.translate(i.x,i.y),l.fillStyle=n(r(i.colorValue)),l.strokeStyle="transparent",e.decorate()(l,t,a),e.pathGenerator.height(i.height).width(i.width)([t]),l.fill(),l.stroke(),l.closePath(),l.restore()})};return q(t,e.pathGenerator,"context"),X(t,e),t},e.seriesCanvasLine=Te,e.seriesCanvasMulti=ca,e.seriesCanvasOhlc=()=>ra(ie()),e.seriesCanvasPoint=ta,e.seriesCanvasRepeat=ha,e.seriesSvgArea=()=>{const e=Ee(),t=s.area(),a=ue("path","area"),n=n=>{n.selection&&a.transition(n),t.defined(e.defined()),n.each((n,i,r)=>{const l=n.map(e.values);t.x((e,t)=>l[t].transposedX).y((e,t)=>l[t].transposedY);const d="vertical"===e.orient()?"y":"x";t[d+"0"]((e,t)=>l[t].y0),t[d+"1"]((e,t)=>l[t].y);const s=a(o.select(r[i]),[n]);s.enter().attr("fill",Ie.gray),s.attr("d",t),e.decorate()(s,n,i)})};return X(n,e,Z("bandwidth","align")),q(n,a,"key"),q(n,t,"curve"),n},e.seriesSvgBar=()=>{const e=re().x(0).y(0),t=Ee(),a=ue("g","bar"),n=e=>"vertical"===t.orient()?e.height:e.width,r=e=>"vertical"===t.orient()?e.width:e.height,l=e=>"translate("+e[0]+", "+e[1]+")",d=i=>{i.selection&&a.transition(i),i.each((i,d,s)=>{const c=t.orient();if("vertical"!==c&&"horizontal"!==c)throw new Error("The bar series does not support an orientation of "+c);const u=i.filter(t.defined()),h=u.map(t.values);e.width(0).height(0),"vertical"===t.orient()?(e.verticalAlign("top"),e.horizontalAlign("center")):(e.horizontalAlign("right"),e.verticalAlign("center"));const f=a(o.select(s[d]),u);f.enter().attr("transform",(e,t)=>l(h[t].baseOrigin)).attr("class","bar "+t.orient()).attr("fill",Ie.darkGray).append("path").attr("d",(t,a)=>(r(e)(h[a].width),e([t]))),f.attr("transform",(e,t)=>l(h[t].origin)).select("path").attr("d",(t,a)=>(r(e)(h[a].width),n(e)(-h[a].height),e([t]))),t.decorate()(f,u,d)})};return X(d,t),q(d,a,"key"),d},e.seriesSvgBoxPlot=()=>{const e=da(),t=ue("g","box-plot"),a=de().value(0),n=e=>t=>e.selection?t.transition(e):t,r=e=>"translate("+e.origin[0]+", "+e.origin[1]+")",l=i=>{i.selection&&t.transition(i);const l=n(i);i.each((n,i,d)=>{const s=n.filter(e.defined()),c=t(o.select(d[i]),s);c.enter().attr("stroke",Ie.black).attr("fill",Ie.gray).attr("transform",(t,a)=>r(e.values(t,a))+" scale(1e-6, 1)").append("path"),a.orient(e.orient()),c.each((t,n,i)=>{const d=e.values(t,n);a.median(d.median).upperQuartile(d.upperQuartile).lowerQuartile(d.lowerQuartile).width(d.width).high(d.high).low(d.low),l(o.select(i[n])).attr("transform",r(d)).select("path").attr("d",a([t]))}),e.decorate()(c,n,i)})};return X(l,e),q(l,t,"key"),q(l,a,"cap"),l},e.seriesSvgCandlestick=()=>ia(le(),"candlestick"),e.seriesSvgErrorBar=()=>{const e=aa(),t=ue("g","error-bar"),a=oe().value(0),n=e=>t=>e.selection?t.transition(e):t,r=e=>"translate("+e.origin[0]+", "+e.origin[1]+")",l=i=>{i.selection&&t.transition(i);const l=n(i);i.each((n,i,d)=>{const s=n.filter(e.defined()),c=s.map(e.values),u=t(o.select(d[i]),s);u.enter().attr("stroke",Ie.black).attr("fill",Ie.gray).attr("transform",(t,a)=>r(e.values(t,a))+" scale(1e-6, 1)").append("path"),a.orient(e.orient()),u.each((e,t,n)=>{const i=c[t];a.high(i.high).low(i.low).width(i.width),l(o.select(n[t])).attr("transform",r(i)+" scale(1)").select("path").attr("d",a([e]))}),e.decorate()(u,n,i)})};return X(l,e),q(l,t,"key"),l},e.seriesSvgGrouped=e=>{const t=ua(),a=ue("g","grouped"),n=n=>{n.selection&&a.transition(n),n.each((n,i,r)=>{const l=a(o.select(r[i]),n);l.enter().append("g"),l.select("g").each((a,r,l)=>{const d=o.select(l[r]),s="horizontal"!==e.orient(),c=(e,a)=>{const i=t.offsetScaleForDatum(n,e,a),l=s?t.xScale():t.yScale();return l(e)+i(r)+i.bandwidth()/2};s?(e.xScale(c),e.yScale(t.yScale())):(e.yScale(c),e.xScale(t.xScale())),e.bandwidth&&e.bandwidth((e,a)=>t.offsetScaleForDatum(n,e,a).bandwidth()),e.decorate((e,a)=>t.decorate()(e,a,r)),d.call(e)})})};return X(n,e,Z("decorate","xScale","yScale")),X(n,t,Z("offsetScaleForDatum")),n},e.seriesSvgHeatmap=()=>{const e=fa(),t=ue("g","box"),a=e=>"translate("+e.x+", "+e.y+")",n=n=>{n.each((n,i,r)=>{const l=n.filter(e.defined()),s=e.colorValue(),c=e.colorInterpolate(),u=e.colorScale(l),h=t(o.select(r[i]),l);h.enter().append("path").attr("stroke","transparent"),h.attr("transform",(t,n)=>a(e.values(t,n))).select("path").attr("d",(t,a)=>e.pathGenerator.width(e.values(t,a).width).height(e.values(t,a).height)([t])).attr("fill",(e,t)=>c(u(s(e,t)))),e.decorate()(h,n,i)})};return X(n,e),n},e.seriesSvgLine=_e,e.seriesSvgMulti=sa,e.seriesSvgOhlc=()=>ia(ie(),"ohlc"),e.seriesSvgPoint=ea,e.seriesSvgRepeat=()=>{let e="vertical",t=_e();const a=sa(),n=n=>n.each((n,i,r)=>{"vertical"===e?a.series(n[0].map(()=>t)).mapping((e,t)=>e.map(e=>e[t])):a.series(n.map(()=>t)).mapping((e,t)=>e[t]),o.select(r[i]).call(a)});return n.series=(...e)=>e.length?(t=e[0],n):t,n.orient=(...t)=>t.length?(e=t[0],n):e,X(n,a,Z("series","mapping")),n},e.seriesWebglArea=()=>{const e=Ee(),t=Ct(0,1),a=t.offset(1),n=Ct(0,1),i=n.offset(1),r=Ct(0,1),l=r.offset(1),d=Ct(0,1).type(ft.UNSIGNED_BYTE),o=d.offset(1),s=St().crossValueAttribute(t).crossNextValueAttribute(a).mainValueAttribute(n).mainNextValueAttribute(i).baseValueAttribute(r).baseNextValueAttribute(l).definedAttribute(d).definedNextAttribute(o);let c=()=>!1,u=qt,h=[],g=null,f=null;const p=a=>{if("vertical"!==e.orient())throw new Error(`Unsupported orientation ${e.orient()}`);const l=u(e.xScale()),o=u(e.yScale()),p=!c(h,a);p&&(h=a,d.value((t,a)=>e.defined()(t,a)).data(a)),(p||l.scale!==g)&&(g=l.scale,t.value((t,a)=>l.scale(e.crossValue()(t,a))).data(a)),(p||o.scale!==f)&&(f=o.scale,r.value((t,a)=>o.scale(e.baseValue()(t,a))).data(a),n.value((t,a)=>o.scale(e.mainValue()(t,a))).data(a)),s.xScale(l.webglScale).yScale(o.webglScale).decorate(t=>e.decorate()(t,a,0)),s(a.length)};return p.equals=(...e)=>e.length?(c=e[0],p):c,p.scaleMapper=(...e)=>e.length?(u=e[0],p):u,X(p,e,Z("bandwidth","align")),q(p,s,"context"),p},e.seriesWebglBar=()=>{const e=Ee(),t=Ht(),a=Ht(),n=Ht(),i=Ht().type(ft.UNSIGNED_SHORT),r=Ht().type(ft.UNSIGNED_BYTE),l=Nt().crossValueAttribute(t).mainValueAttribute(a).baseValueAttribute(n).bandwidthAttribute(i).definedAttribute(r);let d=()=>!1,o=qt,s=[],c=null,u=null;const h=h=>{if("vertical"!==e.orient())throw new Error(`Unsupported orientation ${e.orient()}`);const g=o(e.xScale()),f=o(e.yScale()),p=!d(s,h);p&&(s=h,i.value((t,a)=>e.bandwidth()(t,a)).data(h),r.value((t,a)=>e.defined()(t,a)).data(h)),(p||g.scale!==c)&&(c=g.scale,t.value((t,a)=>g.scale(e.crossValue()(t,a))).data(h)),(p||f.scale!==u)&&(u=f.scale,n.value((t,a)=>f.scale(e.baseValue()(t,a))).data(h),a.value((t,a)=>f.scale(e.mainValue()(t,a))).data(h)),l.xScale(g.webglScale).yScale(f.webglScale).decorate(t=>e.decorate()(t,h,0)),l(h.length)};return h.equals=(...e)=>e.length?(d=e[0],h):d,h.scaleMapper=(...e)=>e.length?(o=e[0],h):o,X(h,e,Z("align")),q(h,l,"context"),h},e.seriesWebglBoxPlot=()=>{const e=da(),t=Ht(),a=Ht(),n=Ht(),i=Ht(),r=Ht(),l=Ht(),d=Ht().type(ft.UNSIGNED_SHORT),o=Ht().type(ft.UNSIGNED_SHORT),s=Ht().type(ft.UNSIGNED_BYTE),c=Lt().crossValueAttribute(t).highValueAttribute(a).upperQuartileValueAttribute(n).medianValueAttribute(i).lowerQuartileValueAttribute(r).lowValueAttribute(l).bandwidthAttribute(d).capAttribute(o).definedAttribute(s);let u=()=>!1,h=qt,g=[],f=null,p=null,m=Ae(20);const b=b=>{if("vertical"!==e.orient())throw new Error(`Unsupported orientation ${e.orient()}`);const y=h(e.xScale()),x=h(e.yScale()),v=!u(g,b);v&&(g=b,d.value((t,a)=>e.bandwidth()(t,a)).data(b),o.value((e,t)=>m(e,t)).data(b),s.value((t,a)=>e.defined()(t,a)).data(b)),(v||y.scale!==f)&&(f=y.scale,t.value((t,a)=>y.scale(e.crossValue()(t,a))).data(b)),(v||x.scale!==p)&&(p=x.scale,a.value((t,a)=>x.scale(e.highValue()(t,a))).data(b),n.value((t,a)=>x.scale(e.upperQuartileValue()(t,a))).data(b),i.value((t,a)=>x.scale(e.medianValue()(t,a))).data(b),r.value((t,a)=>x.scale(e.lowerQuartileValue()(t,a))).data(b),l.value((t,a)=>x.scale(e.lowValue()(t,a))).data(b)),c.xScale(y.webglScale).yScale(x.webglScale).decorate(t=>e.decorate()(t,b,0)),c(b.length)};return b.cap=(...e)=>e.length?(m=Ae(e[0]),b):m,b.equals=(...e)=>e.length?(u=e[0],b):u,b.scaleMapper=(...e)=>e.length?(h=e[0],b):h,X(b,e,Z("align")),q(b,c,"context","lineWidth"),b},e.seriesWebglCandlestick=()=>la(Pt()),e.seriesWebglErrorBar=()=>{const e=aa(),t=Ht(),a=Ht(),n=Ht(),i=Ht().type(ft.UNSIGNED_SHORT),r=Ht().type(ft.UNSIGNED_BYTE),l=Rt().crossValueAttribute(t).highValueAttribute(a).lowValueAttribute(n).bandwidthAttribute(i).definedAttribute(r);let d=()=>!1,o=qt,s=[],c=null,u=null;const h=h=>{if("vertical"!==e.orient())throw new Error(`Unsupported orientation ${e.orient()}`);const g=o(e.xScale()),f=o(e.yScale()),p=!d(s,h);p&&(s=h,i.value((t,a)=>e.bandwidth()(t,a)).data(h),r.value((t,a)=>e.defined()(t,a)).data(h)),(p||g.scale!==c)&&(c=g.scale,t.value((t,a)=>g.scale(e.crossValue()(t,a))).data(h)),(p||f.scale!==u)&&(u=f.scale,a.value((t,a)=>f.scale(e.highValue()(t,a))).data(h),n.value((t,a)=>f.scale(e.lowValue()(t,a))).data(h)),l.xScale(g.webglScale).yScale(f.webglScale).decorate(t=>e.decorate()(t,h,0)),l(h.length)};return h.equals=(...e)=>e.length?(d=e[0],h):d,h.scaleMapper=(...e)=>e.length?(o=e[0],h):o,X(h,e,Z("align")),q(h,l,"context","lineWidth"),h},e.seriesWebglLine=()=>{const e=Ee(),t=Ct(-1,2),a=t.offset(-1),n=t.offset(1),i=t.offset(2),r=Ct(-1,2),l=r.offset(-1),d=r.offset(1),o=r.offset(2),s=Ct(0,1).type(ft.UNSIGNED_BYTE),c=s.offset(1),u=Et().crossPreviousValueAttribute(a).crossValueAttribute(t).crossNextValueAttribute(n).crossNextNextValueAttribute(i).mainPreviousValueAttribute(l).mainValueAttribute(r).mainNextValueAttribute(d).mainNextNextValueAttribute(o).definedAttribute(s).definedNextAttribute(c);let h=()=>!1,g=qt,f=[],p=null,m=null;const b=a=>{const n=g(e.xScale()),l=g(e.yScale()),d=!h(f,a);d&&(f=a,s.value((t,a)=>e.defined()(t,a)).data(a)),(d||n.scale!==p)&&(p=n.scale,"vertical"===e.orient()?t.value((t,a)=>n.scale(e.crossValue()(t,a))).data(a):t.value((t,a)=>n.scale(e.mainValue()(t,a))).data(a)),(d||l.scale!==m)&&(m=l.scale,"vertical"===e.orient()?r.value((t,a)=>l.scale(e.mainValue()(t,a))).data(a):r.value((t,a)=>l.scale(e.crossValue()(t,a))).data(a)),u.xScale(n.webglScale).yScale(l.webglScale).decorate(t=>e.decorate()(t,a,0)),u(a.length)};return b.equals=(...e)=>e.length?(h=e[0],b):h,b.scaleMapper=(...e)=>e.length?(g=e[0],b):g,X(b,e,Z("baseValue","bandwidth","align")),q(b,u,"context","lineWidth"),b},e.seriesWebglMulti=ca,e.seriesWebglOhlc=()=>la(_t()),e.seriesWebglPoint=()=>{const e=Ee();let t=Ae(64),a=s.symbolCircle;const n=Ht(),i=Ht(),r=Ht().type(ft.UNSIGNED_SHORT),l=Ht().type(ft.UNSIGNED_BYTE),d=At().crossValueAttribute(n).mainValueAttribute(i).sizeAttribute(r).definedAttribute(l);let o=()=>!1,c=qt,u=[],h=null,g=null;const f=s=>{const f=c(e.xScale()),p=c(e.yScale()),m=!o(u,s);m&&(u=s,r.value((e,a)=>t(e,a)).data(s),l.value((t,a)=>e.defined()(t,a)).data(s)),(m||f.scale!==h)&&(h=f.scale,"vertical"===e.orient()?n.value((t,a)=>f.scale(e.crossValue()(t,a))).data(s):n.value((t,a)=>f.scale(e.mainValue()(t,a))).data(s)),(m||p.scale!==g)&&(g=p.scale,"vertical"===e.orient()?i.value((t,a)=>p.scale(e.mainValue()(t,a))).data(s):i.value((t,a)=>p.scale(e.crossValue()(t,a))).data(s)),d.xScale(f.webglScale).yScale(p.webglScale).type(Jt(a)).decorate(t=>e.decorate()(t,s,0)),d(s.length)};return f.size=(...e)=>e.length?(t=Ae(e[0]),f):t,f.type=(...e)=>e.length?(a=e[0],f):a,f.equals=(...e)=>e.length?(o=e[0],f):o,f.scaleMapper=(...e)=>e.length?(c=e[0],f):c,X(f,e,Z("baseValue","bandwidth","align")),q(f,d,"context"),f},e.seriesWebglRepeat=ha,e.shapeBar=re,e.shapeBoxPlot=de,e.shapeCandlestick=le,e.shapeErrorBar=oe,e.shapeOhlc=ie,e.webglAdjacentElementAttribute=Ct,e.webglBaseAttribute=pt,e.webglBufferBuilder=Be,e.webglElementAttribute=Ht,e.webglElementIndices=xt,e.webglFillColor=(e=[0,0,0,1])=>{const t=Ht().size(4);let a=e,n=!0;const i=e=>{if(e.vertexShader().appendHeaderIfNotExists(He.header).appendBodyIfNotExists(He.body),e.fragmentShader().appendHeaderIfNotExists(ct.header).appendBodyIfNotExists(ct.body),!!n){if(Array.isArray(a))e.buffers().attribute("aFillColor",$t(a).size(4));else if("function"==typeof a)t.value(a),e.buffers().attribute("aFillColor",t);else throw new Error(`Expected value to be an array or function, received ${a}`);n=!1}};return i.value=(...e)=>e.length?(a!==e[0]&&(a=e[0],n=!0),i):a,q(i,t,"data"),i},e.webglProgramBuilder=Pe,e.webglScaleLinear=Ot,e.webglScaleLog=Gt,e.webglScaleMapper=qt,e.webglScalePow=Ut,e.webglSeriesArea=St,e.webglSeriesBar=Nt,e.webglSeriesBoxPlot=Lt,e.webglSeriesCandlestick=Pt,e.webglSeriesErrorBar=Rt,e.webglSeriesLine=Et,e.webglSeriesOhlc=_t,e.webglSeriesPoint=At,e.webglShaderBuilder=De,e.webglStrokeColor=(e=[0,0,0,1])=>{const t=Ht().size(4);let a=e,n=!0;const i=e=>{if(e.vertexShader().appendHeaderIfNotExists(Oe.header).appendBodyIfNotExists(Oe.body),e.fragmentShader().appendHeaderIfNotExists(ut.header).appendBodyIfNotExists(ut.body),!!n){if(Array.isArray(a))e.buffers().attribute("aStrokeColor",$t(a).size(4));else if("function"==typeof a)t.value(a),e.buffers().attribute("aStrokeColor",t);else throw new Error(`Expected value to be an array or function, received ${a}`);n=!1}};return i.value=(...e)=>e.length?(a!==e[0]&&(a=e[0],n=!0),i):a,q(i,t,"data"),i},e.webglSymbolMapper=Jt,e.webglTypes=ft,e.webglUniform=Re,e.webglVertexAttribute=yt,Object.defineProperty(e,"__esModule",{value:!0})});
